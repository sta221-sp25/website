<!DOCTYPE html>
<html lang="en"><head>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-html/tabby.min.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.6.42">

  <meta name="author" content="Prof.&nbsp;Maria Tackett">
  <title>STA 221 - Spring 2025 – Logistic Regression: Model comparison</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
    /* CSS for citations */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
      margin-bottom: 0em;
    }
    .hanging-indent div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }  </style>
  <link rel="stylesheet" href="../site_libs/revealjs/dist/theme/quarto-ad3f6030a6f024998bc8946f4dfb0128.css">
  <link href="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <script src="../site_libs/kePrint/kePrint.js"></script>
  <link href="../site_libs/lightable/lightable.css" rel="stylesheet">
</head>
<body class="quarto-light">
<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {enableAssistiveMml: false}});</script>
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Logistic Regression: Model comparison</h1>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Prof.&nbsp;Maria Tackett 
</div>
</div>
</div>

  <p class="date">Apr 01, 2025</p>
</section>
<section id="announcements" class="slide level2 midi">
<h2>Announcements</h2>
<ul>
<li><p>HW 04 due April 10 - released later today</p></li>
<li><p>Team Feedback (email from TEAMMATES) due Tuesday, April 8 at 11:59pm (check email)</p></li>
<li><p>Next project milestone: Analysis and draft in April 11 lab</p></li>
<li><p>Statistics experience due April 22</p></li>
</ul>
</section>
<section id="questions-about-the-lecture" class="slide level2">
<h2>Questions about the lecture</h2>
</section>
<section id="topics" class="slide level2">
<h2>Topics</h2>
<ul>
<li><p>Comparing models using AIC and BIC</p></li>
<li><p>Test of significance for a subset of predictors</p></li>
</ul>
</section>
<section id="computational-setup" class="slide level2">
<h2>Computational setup</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a></a><span class="fu">library</span>(tidymodels)</span>
<span id="cb1-3"><a></a><span class="fu">library</span>(pROC)      </span>
<span id="cb1-4"><a></a><span class="fu">library</span>(knitr)</span>
<span id="cb1-5"><a></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb1-6"><a></a></span>
<span id="cb1-7"><a></a><span class="co"># set default theme in ggplot2</span></span>
<span id="cb1-8"><a></a>ggplot2<span class="sc">::</span><span class="fu">theme_set</span>(ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="risk-of-coronary-heart-disease" class="slide level2 midi">
<h2>Risk of coronary heart disease</h2>
<p>This data set is from an ongoing cardiovascular study on residents of the town of Framingham, Massachusetts. We want to examine the relationship between various health characteristics and the risk of having heart disease.</p>
<ul>
<li><p><code>high_risk</code>:</p>
<ul>
<li>1: High risk of having heart disease in next 10 years</li>
<li>0: Not high risk of having heart disease in next 10 years</li>
</ul></li>
<li><p><code>age</code>: Age at exam time (in years)</p></li>
<li><p><code>totChol</code>: Total cholesterol (in mg/dL)</p></li>
<li><p><code>currentSmoker</code>: 0 = nonsmoker, 1 = smoker</p></li>
<li><p><code>education</code>: 1 = Some High School, 2 = High School or GED, 3 = Some College or Vocational School, 4 = College</p></li>
</ul>
</section>
<section id="modeling-risk-of-coronary-heart-disease" class="slide level2">
<h2>Modeling risk of coronary heart disease</h2>
<p>Using <code>age</code>, <code>totChol</code>, <code>currentSmoker</code></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a></a>heart_disease_fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(high_risk <span class="sc">~</span> age <span class="sc">+</span> totChol <span class="sc">+</span> currentSmoker, </span>
<span id="cb2-2"><a></a>              <span class="at">data =</span> heart_disease, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb2-3"><a></a></span>
<span id="cb2-4"><a></a><span class="fu">tidy</span>(heart_disease_fit, <span class="at">conf.int =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb2-5"><a></a>  <span class="fu">kable</span>(<span class="at">digits =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top">
<colgroup>
<col style="width: 21%">
<col style="width: 12%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 11%">
<col style="width: 12%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">term</th>
<th style="text-align: right;">estimate</th>
<th style="text-align: right;">std.error</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
<th style="text-align: right;">conf.low</th>
<th style="text-align: right;">conf.high</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-6.673</td>
<td style="text-align: right;">0.378</td>
<td style="text-align: right;">-17.647</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">-7.423</td>
<td style="text-align: right;">-5.940</td>
</tr>
<tr class="even">
<td style="text-align: left;">age</td>
<td style="text-align: right;">0.082</td>
<td style="text-align: right;">0.006</td>
<td style="text-align: right;">14.344</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.071</td>
<td style="text-align: right;">0.094</td>
</tr>
<tr class="odd">
<td style="text-align: left;">totChol</td>
<td style="text-align: right;">0.002</td>
<td style="text-align: right;">0.001</td>
<td style="text-align: right;">1.940</td>
<td style="text-align: right;">0.052</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.004</td>
</tr>
<tr class="even">
<td style="text-align: left;">currentSmoker1</td>
<td style="text-align: right;">0.443</td>
<td style="text-align: right;">0.094</td>
<td style="text-align: right;">4.733</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.260</td>
<td style="text-align: right;">0.627</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="modeling-risk-of-coronary-heart-disease-1" class="slide level2">
<h2>Modeling risk of coronary heart disease</h2>
<p>Using <code>age</code>, <code>totChol</code>, and <code>currentSmoker</code></p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<table class="caption-top">
<colgroup>
<col style="width: 21%">
<col style="width: 12%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 11%">
<col style="width: 12%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">term</th>
<th style="text-align: right;">estimate</th>
<th style="text-align: right;">std.error</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
<th style="text-align: right;">conf.low</th>
<th style="text-align: right;">conf.high</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-6.673</td>
<td style="text-align: right;">0.378</td>
<td style="text-align: right;">-17.647</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">-7.423</td>
<td style="text-align: right;">-5.940</td>
</tr>
<tr class="even">
<td style="text-align: left;">age</td>
<td style="text-align: right;">0.082</td>
<td style="text-align: right;">0.006</td>
<td style="text-align: right;">14.344</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.071</td>
<td style="text-align: right;">0.094</td>
</tr>
<tr class="odd">
<td style="text-align: left;">totChol</td>
<td style="text-align: right;">0.002</td>
<td style="text-align: right;">0.001</td>
<td style="text-align: right;">1.940</td>
<td style="text-align: right;">0.052</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.004</td>
</tr>
<tr class="even">
<td style="text-align: left;">currentSmoker1</td>
<td style="text-align: right;">0.443</td>
<td style="text-align: right;">0.094</td>
<td style="text-align: right;">4.733</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.260</td>
<td style="text-align: right;">0.627</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="review-roc-curve-model-fit" class="slide level2">
<h2>Review: ROC Curve + Model fit</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a></a>high_risk_aug <span class="ot">&lt;-</span> <span class="fu">augment</span>(high_risk_fit)</span>
<span id="cb3-2"><a></a></span>
<span id="cb3-3"><a></a>roc_curve_data <span class="ot">&lt;-</span> high_risk_aug <span class="sc">|&gt;</span></span>
<span id="cb3-4"><a></a>  <span class="fu">roc_curve</span>(high_risk, .fitted, <span class="at">event_level =</span> <span class="st">"second"</span>)</span>
<span id="cb3-5"><a></a></span>
<span id="cb3-6"><a></a><span class="co">#calculate AUC</span></span>
<span id="cb3-7"><a></a>high_risk_aug <span class="sc">|&gt;</span></span>
<span id="cb3-8"><a></a>  <span class="fu">roc_auc</span>(high_risk, .fitted, <span class="at">event_level =</span> <span class="st">"second"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 3
  .metric .estimator .estimate
  &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt;
1 roc_auc binary         0.697</code></pre>
</div>
</div>
</section>
<section id="review-classification" class="slide level2">
<h2>Review: Classification</h2>
<p>We will use a threshold of 0.2 to classify observations</p>

<img data-src="21-logistic-comparison_files/figure-revealjs/unnamed-chunk-6-1.png" class="quarto-figure quarto-figure-center r-stretch" width="768"></section>
<section id="review-classification-1" class="slide level2 midi">
<h2>Review: Classification</h2>

<img data-src="21-logistic-comparison_files/figure-revealjs/unnamed-chunk-7-1.png" class="quarto-figure quarto-figure-center r-stretch" width="768"><div class="question">
<ol type="1">
<li><p>Compute the misclassification rate.</p></li>
<li><p>Compute sensitivity and explain what it means in the context of the data.</p></li>
<li><p>Compute specificity and explain what it means in the context of the data.</p></li>
</ol>
</div>
</section>
<section>
<section id="model-comparison" class="title-slide slide level1 center">
<h1>Model comparison</h1>

</section>
<section id="which-model-do-we-choose" class="slide level2">
<h2>Which model do we choose?</h2>
<div class="columns">
<div class="column" style="width:50%;">
<center>
<strong>Model 1</strong>
</center>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;">term</th>
<th style="text-align: right;">estimate</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-6.673</td>
</tr>
<tr class="even">
<td style="text-align: left;">age</td>
<td style="text-align: right;">0.082</td>
</tr>
<tr class="odd">
<td style="text-align: left;">totChol</td>
<td style="text-align: right;">0.002</td>
</tr>
<tr class="even">
<td style="text-align: left;">currentSmoker1</td>
<td style="text-align: right;">0.443</td>
</tr>
</tbody>
</table>
</div>
</div>
</div><div class="column" style="width:50%;">
<center>
<strong>Model 2</strong>
</center>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;">term</th>
<th style="text-align: right;">estimate</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-6.456</td>
</tr>
<tr class="even">
<td style="text-align: left;">age</td>
<td style="text-align: right;">0.080</td>
</tr>
<tr class="odd">
<td style="text-align: left;">totChol</td>
<td style="text-align: right;">0.002</td>
</tr>
<tr class="even">
<td style="text-align: left;">currentSmoker1</td>
<td style="text-align: right;">0.445</td>
</tr>
<tr class="odd">
<td style="text-align: left;">education2</td>
<td style="text-align: right;">-0.270</td>
</tr>
<tr class="even">
<td style="text-align: left;">education3</td>
<td style="text-align: right;">-0.232</td>
</tr>
<tr class="odd">
<td style="text-align: left;">education4</td>
<td style="text-align: right;">-0.035</td>
</tr>
</tbody>
</table>
</div>
</div>
</div></div>
</section>
<section id="aic-bic" class="slide level2">
<h2>AIC &amp; BIC</h2>
<p>Estimators of prediction error and <em>relative</em> quality of models:</p>
<div class="fragment">
<p><strong>Akaike’s Information Criterion (AIC)</strong><sup>1</sup>: <span class="math display">\[AIC = -2\log L + 2(p+1)\]</span></p>
</div>
<div class="fragment">
<p><strong>Schwarz’s Bayesian Information Criterion (BIC)</strong><sup>2</sup>: <span class="math display">\[ BIC = -2\log L + \log(n)\times(p+1)\]</span></p>
</div>
<aside><ol class="aside-footnotes"><li id="fn1"><p>Akaike, Hirotugu. <a href="https://ieeexplore.ieee.org/stamp/stamp.jsp?tp=&amp;arnumber=1100705">“A new look at the statistical model identification.”</a> <em>IEEE transactions on automatic control</em> 19.6 (1974): 716-723.</p></li><li id="fn2"><p>Schwarz, Gideon. <a href="https://projecteuclid.org/journalArticle/Download?urlId=10.1214%2Faos%2F1176344136">“Estimating the dimension of a model.”</a> <em>The annals of statistics</em> (1978): 461-464.</p></li></ol></aside></section>
<section id="aic-bic-1" class="slide level2">
<h2>AIC &amp; BIC</h2>
<p><span class="math display">\[
\begin{aligned}
&amp; AIC = \color{blue}{-2\log L}  \color{black}{+ 2(p+1)} \\
&amp; BIC = \color{blue}{-2\log L}  + \color{black}{\log(n)\times(p+1)}
\end{aligned}
\]</span></p>
<div class="fragment">
<p><br></p>
<p>First Term: Decreases as <em>p</em> increases</p>
</div>
</section>
<section id="aic-bic-2" class="slide level2">
<h2>AIC &amp; BIC</h2>
<p><span class="math display">\[
\begin{aligned} &amp; AIC = -2\log L  + \color{blue}{2(p+1)} \\
&amp; BIC = -2\log L + \color{blue}{\log(n)\times(p+1)}
\end{aligned}
\]</span></p>
<p><br></p>
<p>Second term: Increases as <em>p</em> increases</p>
</section>
<section id="using-aic-bic" class="slide level2">
<h2>Using AIC &amp; BIC</h2>
<p><span class="math display">\[
\begin{aligned} &amp; AIC = -2\log L  + \color{red}{2(p+1)} \\
&amp; BIC = -2 \log L  + \color{red}{\log(n)\times(p+1)}
\end{aligned}
\]</span></p>
<ul>
<li><p>Choose model with the smaller value of AIC or BIC</p></li>
<li><p>If <span class="math inline">\(n \geq 8\)</span>, the <strong>penalty</strong> for BIC is larger than that of AIC, so BIC tends to favor <em>more parsimonious</em> models (i.e.&nbsp;models with fewer terms)</p></li>
</ul>
</section>
<section id="aic-from-the-glance-function" class="slide level2">
<h2>AIC from the <code>glance()</code> function</h2>
<p>Let’s look at the AIC for the model that includes <code>age</code>, <code>totChol</code>, and <code>currentSmoker</code></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a></a><span class="fu">glance</span>(high_risk_fit)<span class="sc">$</span>AIC</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3232.812</code></pre>
</div>
</div>
<p><br></p>
<div class="fragment">
<p><strong>Calculating AIC</strong></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a></a><span class="sc">-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">glance</span>(high_risk_fit)<span class="sc">$</span>logLik <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> (<span class="dv">3</span> <span class="sc">+</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3232.812</code></pre>
</div>
</div>
</div>
</section>
<section id="comparing-the-models-using-aic" class="slide level2">
<h2>Comparing the models using AIC</h2>
<p>Let’s compare the full and reduced models using AIC.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a></a><span class="fu">glance</span>(high_risk_fit_reduced)<span class="sc">$</span>AIC</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3232.812</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a></a><span class="fu">glance</span>(high_risk_fit_full)<span class="sc">$</span>AIC</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3231.6</code></pre>
</div>
</div>
<p><br></p>
<div class="question">
<p>Based on AIC, which model would you choose?</p>
</div>
</section>
<section id="comparing-the-models-using-bic" class="slide level2">
<h2>Comparing the models using BIC</h2>
<p>Let’s compare the full and reduced models using BIC</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a></a><span class="fu">glance</span>(high_risk_fit_reduced)<span class="sc">$</span>BIC</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3258.074</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a></a><span class="fu">glance</span>(high_risk_fit_full)<span class="sc">$</span>BIC</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3275.807</code></pre>
</div>
</div>
<p><br></p>
<div class="question">
<p>Based on BIC, which model would you choose?</p>
</div>
</section></section>
<section id="drop-in-deviance-test" class="title-slide slide level1 center">
<h1>Drop-in-deviance test</h1>

</section>

<section>
<section id="test-for-overall-significance" class="title-slide slide level1 center">
<h1>Test for overall significance</h1>

</section>
<section id="likelihood-ratio-test" class="slide level2">
<h2>Likelihood ratio test</h2>
<p>Similar to linear regression, we can test the overall significance for a logistic regression model, i.e., whether there is at least one non-zero coefficient in the model</p>
<p><span class="math display">\[
\begin{aligned}
&amp;H_0: \beta_1 = \dots = \beta_p = 0 \\
&amp;H_a: \beta_j \neq 0 \text{ for at least one } j
\end{aligned}
\]</span></p>
<div class="fragment">
<p>The <strong>likelihood ratio test</strong> compares the fit of a model with no predictors to the current model.</p>
</div>
</section>
<section id="likelihood-ratio-test-statistic" class="slide level2">
<h2>Likelihood ratio test statistic</h2>
<p>Let <span class="math inline">\(L_0\)</span> and <span class="math inline">\(L_a\)</span> be the likelihood functions of the model under <span class="math inline">\(H_0\)</span> and <span class="math inline">\(H_a\)</span>, respectively. The <strong>likelihood ratio test statistic</strong> is</p>
<p><span class="math display">\[
G = -2[\log L_0 - \log L_a] = -2\sum_{i=1}^n \Big[ y_i \log \Big(\frac{\hat{\pi}^0}{\hat{\pi}^a_i}\Big) + (1 - y_i)\log \Big(\frac{1-\hat{\pi}^0}{1-\hat{\pi}^a_i}\Big)\Big]
\]</span></p>
<p>where <span class="math inline">\(\hat{\pi}^0\)</span> is the predicted probability under <span class="math inline">\(H_0\)</span> and <span class="math inline">\(\hat{\pi}_i^a = \frac{\exp \{x_i^T\boldsymbol{\beta}\}}{1 + \exp \{x_i^T\boldsymbol{\beta}\}}\)</span> is the predicted probability under <span class="math inline">\(H_a\)</span> <sup>1</sup></p>
<aside><ol class="aside-footnotes"><li id="fn3"><p>See <span class="citation" data-cites="wilks1935likelihood">Wilks (<a href="#/references" role="doc-biblioref" onclick="">1935</a>)</span> for explanation of why -2 is included.</p></li></ol></aside></section>
<section id="likelihood-ratio-test-statistic-1" class="slide level2">
<h2>Likelihood ratio test statistic</h2>
<p><span class="math display">\[
G = -2\sum_{i=1}^n \Big[ y_i \log \Big(\frac{\hat{\pi}^0}{\hat{\pi}^a_i}\Big) + (1 - y_i)\log \Big(\frac{1-\hat{\pi}^0}{1-\hat{\pi}^a_i}\Big)\Big]
\]</span></p>
<div class="fragment">
<div>
<ul>
<li class="fragment"><p>When <span class="math inline">\(n\)</span> is large, <span class="math inline">\(G \sim \chi^2_p\)</span>, ( <span class="math inline">\(G\)</span> follows a Chi-square distribution with <span class="math inline">\(p\)</span> degrees of freedom)</p></li>
<li class="fragment"><p>The p-value is calculated as <span class="math inline">\(\text{p-value} = P(\chi^2 &gt; G)\)</span></p></li>
<li class="fragment"><p>Large values of <span class="math inline">\(G\)</span> (small p-values) indicate at least one <span class="math inline">\(\beta_j\)</span> is non-zero</p></li>
</ul>
</div>
</div>
</section>
<section id="chi2-distribution" class="slide level2">
<h2><span class="math inline">\(\chi^2\)</span> distribution</h2>

<img data-src="21-logistic-comparison_files/figure-revealjs/unnamed-chunk-16-1.png" class="quarto-figure quarto-figure-center r-stretch" width="768"></section>
<section id="heart-disease-model-likelihood-ratio-test" class="slide level2">
<h2>Heart disease model: likelihood ratio test</h2>
<p><span class="math display">\[
\begin{aligned}
&amp;H_0: \beta_{age} = \beta_{totChol} = \beta_{currentSmoker} = 0 \\
&amp;H_a: \beta_j \neq 0 \text{ for at least one }j
\end{aligned}\]</span></p>
<div class="fragment">
<p><strong>Fit the null model</strong></p>
<p>(we’ve already fit the alternative model)</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a></a>null_model <span class="ot">&lt;-</span> <span class="fu">glm</span>(high_risk <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> heart_disease, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb17-2"><a></a></span>
<span id="cb17-3"><a></a><span class="fu">tidy</span>(null_model) <span class="sc">|&gt;</span></span>
<span id="cb17-4"><a></a>  <span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;">term</th>
<th style="text-align: right;">estimate</th>
<th style="text-align: right;">std.error</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-1.72294</td>
<td style="text-align: right;">0.0436342</td>
<td style="text-align: right;">-39.486</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
<section id="heart-disease-model-likelihood-ratio-test-1" class="slide level2">
<h2>Heart disease model: likelihood ratio test</h2>
<p><strong>Calculate the log-likelihood for the null and alternative models</strong></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a></a>(L_0 <span class="ot">&lt;-</span> <span class="fu">glance</span>(null_model)<span class="sc">$</span>logLik)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -1737.735</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a></a>(L_a <span class="ot">&lt;-</span> <span class="fu">glance</span>(heart_disease_fit)<span class="sc">$</span>logLik)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -1612.406</code></pre>
</div>
</div>
<div class="fragment">
<p><strong>Calculate the likelihood ratio test statistic</strong></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a></a>(G <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> (L_0 <span class="sc">-</span> L_a))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 250.6572</code></pre>
</div>
</div>
</div>
</section>
<section id="heart-disease-model-likelihood-ratio-test-2" class="slide level2">
<h2>Heart disease model: likelihood ratio test</h2>
<p><strong>Calculate the p-value</strong></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a></a>(p_value <span class="ot">&lt;-</span> <span class="fu">pchisq</span>(G, <span class="at">df =</span> <span class="dv">3</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4.717158e-54</code></pre>
</div>
</div>
<div class="fragment">
<p><strong>Conclusion</strong></p>
<p>The p-value is small, so we reject <span class="math inline">\(H_0\)</span>. The data provide evidence of at least one non-zero model coefficient in the model.</p>
</div>
</section></section>
<section>
<section id="test-a-subset-of-coefficients" class="title-slide slide level1 center">
<h1>Test a subset of coefficients</h1>

</section>
<section id="testing-a-subset-of-coefficients" class="slide level2">
<h2>Testing a subset of coefficients</h2>
<ul>
<li><p>Suppose there are two models:</p>
<ul>
<li><p>Reduced Model: includes predictors <span class="math inline">\(x_1, \ldots, x_q\)</span></p></li>
<li><p>Full Model: includes predictors <span class="math inline">\(x_1, \ldots, x_q, x_{q+1}, \ldots, x_p\)</span></p></li>
</ul></li>
<li><p>We can use the likelihood ratios to see if any of the new predictors are useful</p></li>
</ul>
<div class="fragment">
<p><span class="math display">\[
\begin{aligned}
&amp;H_0: \beta_{q+1} = \dots = \beta_p = 0\\
&amp;H_a: \beta_j \neq 0 \text{ for at least one }j
\end{aligned}
\]</span></p>
</div>
<div class="fragment">
<p>This is called a <strong>drop-in-deviance</strong> test (also known as nested likelihood ratio test)</p>
</div>
</section>
<section id="deviance" class="slide level2 midi">
<h2>Deviance</h2>
<p>The <strong>deviance</strong> is a measure of the degree to which the predicted values are different from the observed values (compares the current model to a “saturated” model)</p>
<p><br></p>
<p>In logistic regression,</p>
<p><span class="math display">\[
D = -2 \log L
\]</span></p>
<p><br></p>
<p><span class="math inline">\(D \sim \chi^2_{n - p - 1}\)</span> ( <span class="math inline">\(D\)</span> follows a Chi-square distribution with <span class="math inline">\(n - p - 1\)</span> degrees of freedom)</p>
<p><br></p>
<p>Note: <span class="math inline">\(n - p - 1\)</span> a the degrees of freedom associated with the error in the model (like residuals)</p>
</section>
<section id="drop-in-deviance-test-1" class="slide level2">
<h2>Drop-in-deviance test</h2>
<p><span class="math display">\[
\begin{aligned}
&amp;H_0: \beta_{q+1} = \dots = \beta_p = 0\\
&amp;H_a: \beta_j \neq 0 \text{ for at least one }j
\end{aligned}
\]</span></p>
<div class="fragment">
<p>The test statistic is</p>
<p><span class="math display">\[
\begin{aligned}
G = D_{reduced} - D_{full} &amp;= -2\log L_{reduced} - (-2 \log L_{full}) \\
&amp;= -2(\log L_{reduced} - \log L_{full})
\end{aligned}
\]</span></p>
</div>
<div class="fragment">
<p>The p-value is calculated using a <span class="math inline">\(\chi_{\Delta df}^2\)</span> distribution, where <span class="math inline">\(\Delta df\)</span> is the number of parameters being tested (the difference in number of parameters between the full and reduced model).</p>
</div>
</section>
<section id="heart-disease-model-drop-in-deviance-test" class="slide level2">
<h2>Heart disease model: drop-in-deviance test</h2>
<p>Should we add <code>education</code> to the model?</p>
<ul>
<li><p>Reduced model: <code>age</code>, <code>totChol</code>, <code>currentSmoker</code></p></li>
<li><p>Full model: <code>age</code>, <code>totChol</code>, <code>currentSmoker</code> , <code>education</code></p></li>
</ul>
<div class="fragment">
<p><span class="math display">\[
\begin{aligned}
&amp;H_0: \beta_{ed1} = \beta_{ed2} = \beta_{ed3} = 0 \\
&amp;H_a: \beta_j \neq 0 \text{ for at least one }j
\end{aligned}
\]</span></p>
</div>
</section>
<section id="heart-disease-model-drop-in-deviance-test-1" class="slide level2 midi">
<h2>Heart disease model: drop-in-deviance test</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a></a>reduced_model <span class="ot">&lt;-</span> <span class="fu">glm</span>(high_risk <span class="sc">~</span> age <span class="sc">+</span> totChol <span class="sc">+</span> currentSmoker, </span>
<span id="cb26-2"><a></a>              <span class="at">data =</span> heart_disease, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb26-3"><a></a></span>
<span id="cb26-4"><a></a>full_model <span class="ot">&lt;-</span> <span class="fu">glm</span>(high_risk <span class="sc">~</span> age <span class="sc">+</span> totChol <span class="sc">+</span> currentSmoker <span class="sc">+</span> education, </span>
<span id="cb26-5"><a></a>              <span class="at">data =</span> heart_disease, <span class="at">family =</span> <span class="st">"binomial"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<p><strong>Calculate deviances</strong></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a></a>(deviance_reduced <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">glance</span>(reduced_model)<span class="sc">$</span>logLik)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3224.812</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a></a>(deviance_full <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">glance</span>(full_model)<span class="sc">$</span>logLik)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3217.6</code></pre>
</div>
</div>
</div>
<div class="fragment">
<p><strong>Calculate test statistic</strong></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a></a>(G <span class="ot">&lt;-</span> deviance_reduced <span class="sc">-</span> deviance_full)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 7.212113</code></pre>
</div>
</div>
</div>
</section>
<section id="heart-disease-model-drop-in-deviance-test-2" class="slide level2">
<h2>Heart disease model: drop-in-deviance test</h2>
<p><strong>Calculate p-value</strong></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a></a><span class="fu">pchisq</span>(G, <span class="at">df =</span> <span class="dv">3</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.06543567</code></pre>
</div>
</div>
<p><br></p>
<div class="fragment">
<div class="question">
<p>What is your conclusion? Would you include <code>education</code> in the model that already has <code>age</code>, <code>totChol</code>, <code>currentSmoker</code>?</p>
</div>
</div>
</section>
<section id="drop-in-deviance-test-in-r" class="slide level2 midi">
<h2>Drop-in-deviance test in R</h2>
<p>Conduct the drop-in-deviance test using the <code>anova()</code> function in R with option <code>test = "Chisq"</code></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a></a><span class="fu">anova</span>(reduced_model, full_model, <span class="at">test =</span> <span class="st">"Chisq"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb35-2"><a></a>  <span class="fu">tidy</span>() <span class="sc">|&gt;</span> </span>
<span id="cb35-3"><a></a>  <span class="fu">kable</span>(<span class="at">digits =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top">
<colgroup>
<col style="width: 51%">
<col style="width: 11%">
<col style="width: 17%">
<col style="width: 2%">
<col style="width: 8%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">term</th>
<th style="text-align: right;">df.residual</th>
<th style="text-align: right;">residual.deviance</th>
<th style="text-align: right;">df</th>
<th style="text-align: right;">deviance</th>
<th style="text-align: right;">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">high_risk ~ age + totChol + currentSmoker</td>
<td style="text-align: right;">4082</td>
<td style="text-align: right;">3224.812</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">high_risk ~ age + totChol + currentSmoker + education</td>
<td style="text-align: right;">4079</td>
<td style="text-align: right;">3217.600</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">7.212</td>
<td style="text-align: right;">0.065</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="aic-and-bic" class="slide level2">
<h2>AIC and BIC</h2>
<p>Similar to linear regression, we can use AIC and BIC to compare models.</p>
<p><span class="math display">\[
\begin{aligned}
&amp;AIC = -2 \log L + 2(p+1) \\
&amp;BIC = -2 \log L + \log(n)(p + 1)
\end{aligned}
\]</span></p>
<p>You want to select the model that minimizes AIC / BIC</p>
</section>
<section id="compare-models-using-aic" class="slide level2">
<h2>Compare models using AIC</h2>
<p>AIC for reduced model (<code>age</code>, <code>totChol</code>, <code>currentSmoker</code>)</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a></a><span class="fu">glance</span>(reduced_model)<span class="sc">$</span>AIC</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3232.812</code></pre>
</div>
</div>
<p><br></p>
<div class="fragment">
<p>AIC for full model (<code>age</code>, <code>totChol</code>, <code>currentSmoker</code>, <code>education</code>)</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a></a><span class="fu">glance</span>(full_model)<span class="sc">$</span>AIC</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3231.6</code></pre>
</div>
</div>
</div>
</section>
<section id="compare-models-using-bic" class="slide level2">
<h2>Compare models using BIC</h2>
<p>BIC for reduced model (<code>age</code>, <code>totChol</code>, <code>currentSmoker</code>)</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a></a><span class="fu">glance</span>(reduced_model)<span class="sc">$</span>BIC</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3258.074</code></pre>
</div>
</div>
<p><br></p>
<div class="fragment">
<p>BIC for full model (<code>age</code>, <code>totChol</code>, <code>currentSmoker</code>, <code>education</code>)</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a></a><span class="fu">glance</span>(full_model)<span class="sc">$</span>BIC</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3275.807</code></pre>
</div>
</div>
</div>
</section></section>
<section>
<section id="test-for-a-single-coefficient" class="title-slide slide level1 center">
<h1>Test for a single coefficient</h1>

</section>
<section id="distribution-of-hatboldsymbolbeta" class="slide level2">
<h2>Distribution of <span class="math inline">\(\hat{\boldsymbol{\beta}}\)</span></h2>
<p>When <span class="math inline">\(n\)</span> is large, <span class="math inline">\(\hat{\boldsymbol{\beta}}\)</span>, the estimated coefficients of the logistic regression model, is approximately normal.</p>
<p><br></p>
<div class="question">
<p>How do we know the distribution of <span class="math inline">\(\hat{\boldsymbol{\beta}}\)</span> is normal for large <span class="math inline">\(n\)</span>?</p>
</div>
</section>
<section id="distribution-of-hatboldsymbolbeta-1" class="slide level2">
<h2>Distribution of <span class="math inline">\(\hat{\boldsymbol{\beta}}\)</span></h2>
<p>The expected value of <span class="math inline">\(\hat{\boldsymbol{\beta}}\)</span> is the true parameter, <span class="math inline">\(\boldsymbol{\beta}\)</span>, i.e., <span class="math inline">\(E(\hat{\boldsymbol{\beta}}) = \boldsymbol{\beta}\)</span></p>
<div class="fragment">
<p><span class="math inline">\(Var(\hat{\boldsymbol{\beta}})\)</span>, the matrix of variances and covariances between estimators, is found by taking the second partial derivatives of the log-likelihood function (Hessian matrix)</p>
<p><span class="math display">\[
Var(\hat{\boldsymbol{\beta}}) = (\mathbf{X}^T\mathbf{V}\mathbf{X})^{-1}
\]</span></p>
<p>where <span class="math inline">\(\mathbf{V}\)</span> is a <span class="math inline">\(n\times n\)</span> diagonal matrix such that <span class="math inline">\(V_{ii}\)</span> is the estimated variance for the <span class="math inline">\(i^{th}\)</span> observation</p>
</div>
</section>
<section id="test-for-a-single-coefficient-1" class="slide level2">
<h2>Test for a single coefficient</h2>
<p><strong>Hypotheses:</strong> <span class="math inline">\(H_0: \beta_j = 0 \hspace{2mm} \text{ vs } \hspace{2mm} H_a: \beta_j \neq 0\)</span>, given the other variables in the model</p>
<div class="fragment">
<p><strong>(Wald) Test Statistic:</strong> <span class="math display">\[z = \frac{\hat{\beta}_j - 0}{SE(\hat{\beta}_j)}\]</span></p>
<p>where <span class="math inline">\(SE(\hat{\beta}_j)\)</span> is the square root of the <span class="math inline">\(j^{th}\)</span> diagonal element of <span class="math inline">\(Var(\hat{\boldsymbol{\beta}})\)</span></p>
</div>
<div class="fragment">
<p><strong>P-value:</strong> <span class="math inline">\(P(|Z| &gt; |z|)\)</span>, where <span class="math inline">\(Z \sim N(0, 1)\)</span>, the Standard Normal distribution</p>
</div>
</section>
<section id="confidence-interval-for-beta_j" class="slide level2">
<h2>Confidence interval for <span class="math inline">\(\beta_j\)</span></h2>
<p>We can calculate the <strong>C% confidence interval</strong> for <span class="math inline">\(\beta_j\)</span> as the following:</p>
<p><span class="math display">\[
\Large{\hat{\beta}_j \pm z^* SE(\hat{\beta}_j)}
\]</span></p>
<p>where <span class="math inline">\(z^*\)</span> is calculated from the <span class="math inline">\(N(0,1)\)</span> distribution</p>
<div class="fragment">
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Note</strong></p>
</div>
<div class="callout-content">
<p>This is an interval for the change in the log-odds for every one unit increase in <span class="math inline">\(x_j\)</span></p>
</div>
</div>
</div>
</div>
</section>
<section id="interpretation-in-terms-of-the-odds" class="slide level2">
<h2>Interpretation in terms of the odds</h2>
<p>The change in <strong>odds</strong> for every one unit increase in <span class="math inline">\(x_j\)</span>.</p>
<p><span class="math display">\[
\Large{\exp\{\hat{\beta}_j \pm z^* SE(\hat{\beta}_j)\}}
\]</span></p>
<div class="fragment">
<p><strong>Interpretation:</strong> We are <span class="math inline">\(C\%\)</span> confident that for every one unit increase in <span class="math inline">\(x_j\)</span>, the odds multiply by a factor of <span class="math inline">\(\exp\{\hat{\beta}_j - z^* SE(\hat{\beta}_j)\}\)</span> to <span class="math inline">\(\exp\{\hat{\beta}_j + z^* SE(\hat{\beta}_j)\}\)</span>, holding all else constant.</p>
</div>
</section>
<section id="coefficient-for-age" class="slide level2 midi">
<h2>Coefficient for <code>age</code></h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<table class="caption-top" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">term</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">std.error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p.value</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">conf.low</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">conf.high</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-6.673</td>
<td style="text-align: right;">0.378</td>
<td style="text-align: right;">-17.647</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">-7.423</td>
<td style="text-align: right;">-5.940</td>
</tr>
<tr class="even">
<td style="text-align: left; background-color: rgba(217, 227, 228, 255) !important;">age</td>
<td style="text-align: right; background-color: rgba(217, 227, 228, 255) !important;">0.082</td>
<td style="text-align: right; background-color: rgba(217, 227, 228, 255) !important;">0.006</td>
<td style="text-align: right; background-color: rgba(217, 227, 228, 255) !important;">14.344</td>
<td style="text-align: right; background-color: rgba(217, 227, 228, 255) !important;">0.000</td>
<td style="text-align: right; background-color: rgba(217, 227, 228, 255) !important;">0.071</td>
<td style="text-align: right; background-color: rgba(217, 227, 228, 255) !important;">0.094</td>
</tr>
<tr class="odd">
<td style="text-align: left;">totChol</td>
<td style="text-align: right;">0.002</td>
<td style="text-align: right;">0.001</td>
<td style="text-align: right;">1.940</td>
<td style="text-align: right;">0.052</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.004</td>
</tr>
<tr class="even">
<td style="text-align: left;">currentSmoker1</td>
<td style="text-align: right;">0.443</td>
<td style="text-align: right;">0.094</td>
<td style="text-align: right;">4.733</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.260</td>
<td style="text-align: right;">0.627</td>
</tr>
</tbody>
</table>


</div>
</div>
<div class="fragment">
<p><strong>Hypotheses:</strong></p>
<p><span class="math display">\[
H_0: \beta_{age} = 0 \hspace{2mm} \text{ vs } \hspace{2mm} H_a: \beta_{age} \neq 0
\]</span>, given total cholesterol and smoking status are in the model.</p>
</div>
</section>
<section id="coefficient-for-age-1" class="slide level2 midi">
<h2>Coefficient for <code>age</code></h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<table class="caption-top" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">term</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">std.error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p.value</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">conf.low</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">conf.high</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-6.673</td>
<td style="text-align: right;">0.378</td>
<td style="text-align: right;">-17.647</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">-7.423</td>
<td style="text-align: right;">-5.940</td>
</tr>
<tr class="even">
<td style="text-align: left; background-color: rgba(217, 227, 228, 255) !important;">age</td>
<td style="text-align: right; background-color: rgba(217, 227, 228, 255) !important;">0.082</td>
<td style="text-align: right; background-color: rgba(217, 227, 228, 255) !important;">0.006</td>
<td style="text-align: right; background-color: rgba(217, 227, 228, 255) !important;">14.344</td>
<td style="text-align: right; background-color: rgba(217, 227, 228, 255) !important;">0.000</td>
<td style="text-align: right; background-color: rgba(217, 227, 228, 255) !important;">0.071</td>
<td style="text-align: right; background-color: rgba(217, 227, 228, 255) !important;">0.094</td>
</tr>
<tr class="odd">
<td style="text-align: left;">totChol</td>
<td style="text-align: right;">0.002</td>
<td style="text-align: right;">0.001</td>
<td style="text-align: right;">1.940</td>
<td style="text-align: right;">0.052</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.004</td>
</tr>
<tr class="even">
<td style="text-align: left;">currentSmoker1</td>
<td style="text-align: right;">0.443</td>
<td style="text-align: right;">0.094</td>
<td style="text-align: right;">4.733</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.260</td>
<td style="text-align: right;">0.627</td>
</tr>
</tbody>
</table>


</div>
</div>
<p><strong>Test statistic:</strong></p>
<p><span class="math display">\[z = \frac{ 0.0825  - 0}{0.00575} = 14.34
\]</span></p>
</section>
<section id="coefficient-for-age-2" class="slide level2 midi">
<h2>Coefficient for <code>age</code></h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<table class="caption-top" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">term</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">std.error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p.value</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">conf.low</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">conf.high</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-6.673</td>
<td style="text-align: right;">0.378</td>
<td style="text-align: right;">-17.647</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">-7.423</td>
<td style="text-align: right;">-5.940</td>
</tr>
<tr class="even">
<td style="text-align: left; background-color: rgba(217, 227, 228, 255) !important;">age</td>
<td style="text-align: right; background-color: rgba(217, 227, 228, 255) !important;">0.082</td>
<td style="text-align: right; background-color: rgba(217, 227, 228, 255) !important;">0.006</td>
<td style="text-align: right; background-color: rgba(217, 227, 228, 255) !important;">14.344</td>
<td style="text-align: right; background-color: rgba(217, 227, 228, 255) !important;">0.000</td>
<td style="text-align: right; background-color: rgba(217, 227, 228, 255) !important;">0.071</td>
<td style="text-align: right; background-color: rgba(217, 227, 228, 255) !important;">0.094</td>
</tr>
<tr class="odd">
<td style="text-align: left;">totChol</td>
<td style="text-align: right;">0.002</td>
<td style="text-align: right;">0.001</td>
<td style="text-align: right;">1.940</td>
<td style="text-align: right;">0.052</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.004</td>
</tr>
<tr class="even">
<td style="text-align: left;">currentSmoker1</td>
<td style="text-align: right;">0.443</td>
<td style="text-align: right;">0.094</td>
<td style="text-align: right;">4.733</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.260</td>
<td style="text-align: right;">0.627</td>
</tr>
</tbody>
</table>


</div>
</div>
<p><strong>P-value:</strong></p>
<p><span class="math display">\[P(|Z| &gt; |14.34|) \approx 0
\]</span></p>
<div class="fragment">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a></a><span class="dv">2</span> <span class="sc">*</span> <span class="fu">pnorm</span>(<span class="fl">14.34</span>,<span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.230554e-46</code></pre>
</div>
</div>
</div>
</section>
<section id="coefficient-for-age-3" class="slide level2 midi">
<h2>Coefficient for <code>age</code></h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<table class="caption-top" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">term</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">std.error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p.value</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">conf.low</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">conf.high</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-6.673</td>
<td style="text-align: right;">0.378</td>
<td style="text-align: right;">-17.647</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">-7.423</td>
<td style="text-align: right;">-5.940</td>
</tr>
<tr class="even">
<td style="text-align: left; background-color: rgba(217, 227, 228, 255) !important;">age</td>
<td style="text-align: right; background-color: rgba(217, 227, 228, 255) !important;">0.082</td>
<td style="text-align: right; background-color: rgba(217, 227, 228, 255) !important;">0.006</td>
<td style="text-align: right; background-color: rgba(217, 227, 228, 255) !important;">14.344</td>
<td style="text-align: right; background-color: rgba(217, 227, 228, 255) !important;">0.000</td>
<td style="text-align: right; background-color: rgba(217, 227, 228, 255) !important;">0.071</td>
<td style="text-align: right; background-color: rgba(217, 227, 228, 255) !important;">0.094</td>
</tr>
<tr class="odd">
<td style="text-align: left;">totChol</td>
<td style="text-align: right;">0.002</td>
<td style="text-align: right;">0.001</td>
<td style="text-align: right;">1.940</td>
<td style="text-align: right;">0.052</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.004</td>
</tr>
<tr class="even">
<td style="text-align: left;">currentSmoker1</td>
<td style="text-align: right;">0.443</td>
<td style="text-align: right;">0.094</td>
<td style="text-align: right;">4.733</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.260</td>
<td style="text-align: right;">0.627</td>
</tr>
</tbody>
</table>


</div>
</div>
<p><strong>Conclusion:</strong></p>
<p>The p-value is very small, so we reject <span class="math inline">\(H_0\)</span>. The data provide sufficient evidence that age is a statistically significant predictor of whether someone is high risk of having heart disease, after accounting for total cholesterol and smoking status.</p>
</section>
<section id="ci-for-age" class="slide level2">
<h2>CI for <code>age</code></h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<table class="caption-top" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">term</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">std.error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p.value</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">conf.low</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">conf.high</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-6.673</td>
<td style="text-align: right;">0.378</td>
<td style="text-align: right;">-17.647</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">-7.423</td>
<td style="text-align: right;">-5.940</td>
</tr>
<tr class="even">
<td style="text-align: left; background-color: rgba(217, 227, 228, 255) !important;">age</td>
<td style="text-align: right; background-color: rgba(217, 227, 228, 255) !important;">0.082</td>
<td style="text-align: right; background-color: rgba(217, 227, 228, 255) !important;">0.006</td>
<td style="text-align: right; background-color: rgba(217, 227, 228, 255) !important;">14.344</td>
<td style="text-align: right; background-color: rgba(217, 227, 228, 255) !important;">0.000</td>
<td style="text-align: right; background-color: rgba(217, 227, 228, 255) !important;">0.071</td>
<td style="text-align: right; background-color: rgba(217, 227, 228, 255) !important;">0.094</td>
</tr>
<tr class="odd">
<td style="text-align: left;">totChol</td>
<td style="text-align: right;">0.002</td>
<td style="text-align: right;">0.001</td>
<td style="text-align: right;">1.940</td>
<td style="text-align: right;">0.052</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.004</td>
</tr>
<tr class="even">
<td style="text-align: left;">currentSmoker1</td>
<td style="text-align: right;">0.443</td>
<td style="text-align: right;">0.094</td>
<td style="text-align: right;">4.733</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.260</td>
<td style="text-align: right;">0.627</td>
</tr>
</tbody>
</table>


</div>
</div>
<div class="question">
<p>Interpret the 95% confidence interval for <code>age</code> in terms of the <strong>odds</strong> of being high risk for heart disease.</p>
</div>
</section>
<section id="overview-of-testing-coefficients" class="slide level2">
<h2>Overview of testing coefficients</h2>
<p><strong>Test a single coefficient</strong></p>
<ul>
<li><p>Likelihood ratio test</p></li>
<li><p>Drop-in-deviance test</p></li>
<li><p>Wald hypothesis test and confidence interval</p></li>
</ul>
<div class="fragment">
<p><strong>Test a subset of coefficients</strong></p>
<ul>
<li><p>Likelihood ratio test</p></li>
<li><p>Drop-in-deviance test</p></li>
</ul>
</div>
<div class="fragment">
<p>Can use AIC and BIC to compare models in both scenarios</p>
</div>
</section>
<section id="references" class="slide level2 smaller scrollable">
<h2>References</h2>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-wilks1935likelihood" class="csl-entry" role="listitem">
Wilks, SS. 1935. <span>“The Likelihood Test of Independence in Contingency Tables.”</span> <em>The Annals of Mathematical Statistics</em> 6 (4): 190–96.
</div>
</div>
</section></section>

    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<p><img src="../images/logo.png" class="slide-logo"></p>
<div class="footer footer-default">
<p><a href="https://sta221-sp25.netlify.app">🔗 STA 221 - Spring 2025</a></p>
</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"8\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'fade',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp("https:\/\/sta221-sp25\.netlify\.app");
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>