{
  "hash": "10e194a4ca095fd59d1365a31f46cdc9",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Lab 04: Exam 01 Review\"\ndate: \"February 14, 2025\"\nhtml-math-method:\n  method: mathjax\n  url: \"https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js\"\neditor: visual\nexecute:\n  warning: false\n  message: false\n---\n\n\n\n::: callout-important\nThis lab will be based on attendance and participation in lab on February 14.\n\nPush your work to GitHub. You do not need to submit anything on Gradescope.\n:::\n\n# Getting Started\n\n-   Go to the [sta221-sp25](https://www.github.com/sta221-sp25) organization on GitHub. Click on the repo with the prefix **lab-04**. It contains the starter documents you need to complete the lab.\n\n-   Clone the repo and start a new project in RStudio. See the [Lab 00 instructions](https://sta221-sp25.netlify.app/labs/lab-00#getting-started) for details on cloning a repo and starting a new project in R.\n\n# Packages\n\nYou will need the following packages for the lab:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(tidymodels) \nlibrary(knitr)\nlibrary(patchwork)\n\n# add other packages as needed\n```\n:::\n\n\n\n# Restaurant tips\n\n**What factors are associated with the amount customers tip at a restaurant?** To answer this question, we will use data collected in 2011 by a student at St. Olaf who worked at a local restaurant.[^1]\n\n[^1]: Dahlquist, Samantha, and Jin Dong. 2011. \"The Effects of Credit Cards on Tipping.\" Project for Statistics 212-Statistics for the Sciences, St. Olaf College.\n\nThe variables we'll focus on for this analysis are\n\n-   `Tip`: amount of the tip\n-   `Party`: number of people in the party\n-   `Age`: Age of the payer\n\nView the data set to see the remaining variables.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntips <- read_csv(\"data/tip-data.csv\")\n```\n:::\n\n\n\n## Exploratory data analysis\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\np1 <- ggplot(data = tips, aes(x = Tip)) + \n  geom_histogram(color = \"white\", binwidth = 2) +\n  labs(x = \"Tips ($)\",\n       title = \"Tips at local restaurant\")\n\np2 <- ggplot(data = tips, aes(x = Party)) + \n  geom_histogram(color = \"white\") +\n  labs(x = \"Party\",\n       title = \"Number of diners in party\") +\n  xlim(c(0, 7))\n\np3 <- ggplot(data = tips, aes(x = Age)) + \n  geom_bar(color = \"white\") +\n  labs(x = \"\",\n       title = \"Age of Payer\") \n\np1 / (p2 + p3)\n```\n\n::: {.cell-output-display}\n![](lab-04-draft_files/figure-html/univariate-eda-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\np4 <- ggplot(data = tips, aes(x = Party, y = Tip)) + \n  geom_jitter() + \n  labs(x = \"Number of diners in party\", \n       y = \"Tips ($)\",\n       title = \"Tips vs. Party\")\n\np5 <- ggplot(data = tips, aes(x = Age, y = Tip)) + \n  geom_boxplot() + \n  labs(x = \"Age of payer\", \n       y = \"Tips ($)\",\n       title = \"Tips vs. Age\")\n\np4 + p5\n```\n\n::: {.cell-output-display}\n![](lab-04-draft_files/figure-html/bivariate-eda-1.png){width=672}\n:::\n:::\n\n\n\n**We will use the number of diners in the party and age of the payer to understand variability in the tips.**\n\n## Exercise 1\n\nWe will start with the main effects model that includes `Age` and `Party`.\n\na.  How many indicator variables for `Age` can we create from the data?\nb.  How many indicator variables for `Age` will be in the regression model?\nc.  Are the responses to parts a and b equal? If not, explain why not.\nd.  Which of the following is true for this model? Select all that apply.\n    i.  The intercepts are the same for every level of `Age`.\n    ii. The intercepts differ by `Age`.\n    iii. The effect of `Party` is the same for every level of `Age`.\n    iv. The effect of `Party` differs by `Age`.\n\n## Exercise 2\n\nConsider the main effects model that includes `Age` and `Party`.\n\na.  What is the dimension of the design matrix $\\mathbf{X}$ for the main effects model?\n\nb.  Calculate the coefficient estimates $\\hat{\\boldsymbol{\\beta}}$ directly from the data.\n\nc.  Write the equation of the estimated regression model.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# add code here \n```\n:::\n\n\n\n## Exercise 3\n\nConsider the main effects model that includes `Age` and `Party`. Get $\\mathbf{y}$ and $\\mathbf{X}$ from the data.\n\na.  Use $\\mathbf{y}$ and $\\mathbf{X}$ to compute $\\hat{\\sigma}_{\\epsilon}$ .\nb.  Interpret $\\hat{\\sigma}_\\epsilon$ in the context of the data.\nc.  Compute $Var(\\hat{\\boldsymbol{\\beta}})$.\nd.  You wish to test whether there is a linear relationship between tips and the number of diners in the party, after adjusting for the age of the payer. Compute the test statistic.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# add code here\n```\n:::\n\n\n\n## Exercise 4\n\nConsider the main effects model that includes `Age` and `Party`. Get $\\mathbf{y}$ and $\\mathbf{X}$ from the data.\n\na.  Use $\\mathbf{y}$ and $\\mathbf{X}$ to compute $R^2$. Interpret this value in the context of the data.\nb.  Use $\\mathbf{y}$ and $\\mathbf{X}$ to compute $RMSE$. Interpret this value in the context of the data.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# add code here\n```\n:::\n\n\n\n## Exercise 5\n\nYou decide to add an interaction effect between `Age` and `Party` to the model and fit a model of the following form:\n\n$$\nTip_i = \\beta_0 + \\beta_1Party_i + \\beta_2SenCit_i + \\beta_3Yadult_i + \\beta_4Party_i \\times SenCit_i + \\beta_5 Party_i \\times Yadult_i + \\epsilon_i\n$$\n\na.  Which of the following is true for this model? Select all that apply.\n    i.  The intercepts are the same for every level of `Age`.\n    ii. The intercepts differ by `Age`.\n    iii. The effect of `Party` is the same for every level of `Age`.\n    iv. The effect of `Party` differs by `Age`.\nb.  By how much does the intercept for tables with young adult payers differ from tables with middle age payers? Write the answer in terms of the $\\beta$'s.\nc.  Write the equation of the model for tables in which the payer is a senior citizen.\nd.  Suppose you wish to test the hypotheses: $H_0: \\beta_5 = 0 \\text{ vs. }H_a: \\beta_5 \\neq 0$ . State what is being tested in terms of the effect of `Party`.\n\n## Exercise 6\n\nUse the `lm()` function to fit the model that includes `Age` and `Party` and the interaction between the two variables. Display the 90% confidence interval for the coefficients.\n\na.   The standard error for `AgeSenCit` is 0.784. State what this value means in the context of the data.\nb.  Write code to show how the 90% confidence interval for `AgeSenCit` was computed.\nc.  Based on the confidence interval, is there evidence that tables with senior citizen payers tip differently on average than tables with middle age payers?\n\n## Exercise 7\n\nThe following are general questions about regression. They are not specific to the tips data set.\n\na.  What does it mean for an estimator to be the \"least-squares\" estimator?\n\nb.  Consider the derivation of the least-squares estimator:\n\n    $$\n    \\begin{aligned}\n     \\nabla_{\\beta}\\boldsymbol{\\epsilon}^\\mathsf{T}\\boldsymbol{\\epsilon} &= \\nabla_{\\boldsymbol{\\beta}}[(\\mathbf{y} - \\mathbf{X}\\boldsymbol{\\beta})^\\mathsf{T}(\\mathbf{y} - \\mathbf{X}\\boldsymbol{\\beta})] \\\\[5pt]\n    &=\\nabla_{\\boldsymbol{\\beta}}[\\mathbf{y}^\\mathsf{T}\\mathbf{y} - \\mathbf{y}^\\mathsf{T}\\mathbf{X}\\boldsymbol{\\beta} - \\boldsymbol{\\beta}^\\mathsf{T}\\mathbf{X}^\\mathsf{T}\\mathbf{y} + \\boldsymbol{\\beta}^\\mathsf{T}\\mathbf{X}^\\mathsf{T}\\mathbf{X}\\boldsymbol{\\beta}] \\\\[5pt]\n    &=\\nabla_{\\boldsymbol{\\beta}}[\\mathbf{y}^\\mathsf{T}\\mathbf{y} - 2\\boldsymbol{\\beta}^\\mathsf{T}\\mathbf{X}^\\mathsf{T}\\mathbf{y} + \\boldsymbol{\\beta}^\\mathsf{T}\\mathbf{X}^\\mathsf{T}\\mathbf{X}\\boldsymbol{\\beta}]\\\\[5pt]\n     & = -2\\mathbf{X}^\\mathsf{T}\\mathbf{y} + 2\\mathbf{X}^\\mathsf{T}\\mathbf{X}\\boldsymbol{\\beta} \\\\[5pt]\n    &\\Rightarrow \\hat{\\boldsymbol{\\beta}} = (\\mathbf{X}^\\mathsf{T}\\mathbf{X})^{-1}\\mathbf{X}^\\mathsf{T}\\mathbf{y}\n    \\end{aligned}\n    $$\n\nExplain how $-\\mathbf{y}^\\mathsf{T}\\mathbf{X}\\boldsymbol{\\beta} - \\boldsymbol{\\beta}^\\mathsf{T}\\mathbf{X}^\\mathsf{T}\\mathbf{y}$ is simplified to $-2\\boldsymbol{\\beta}^\\mathsf{T}\\mathbf{X}^\\mathsf{T}\\mathbf{y}$ when going from lines 2 to 3.\n\nc.  Explain what rules were used to compute the gradient in line 4.\n\n## Exercise 8\n\nBelow we show how SSR = $\\mathbf{y}^\\mathsf{T}\\mathbf{y} - \\hat{\\boldsymbol{\\beta}}^\\mathsf{T}\\mathbf{X}^\\mathsf{T}\\mathbf{y}$\n\n$$\n\\begin{aligned}\nSSR = \\mathbf{e}^\\mathsf{T}\\mathbf{e} &= (\\mathbf{y} - \\mathbf{X}\\hat{\\boldsymbol{\\beta}})^\\mathsf{T}(\\mathbf{y} - \\mathbf{X}\\hat{\\mathbf{\\beta}}) \\\\[5pt]\n& = \\mathbf{y}^\\mathsf{T}\\mathbf{y} - \\mathbf{y}^\\mathsf{T}\\mathbf{X}\\hat{\\boldsymbol{\\beta}} - \\hat{\\boldsymbol{\\beta}}^\\mathsf{T}\\mathbf{X}^\\mathsf{T}\\mathbf{y} + \\hat{\\boldsymbol{\\beta}}^\\mathsf{T}\\mathbf{X}^\\mathsf{T}\\mathbf{X}\\hat{\\boldsymbol{\\beta}} \\\\[5pt]\n&= \\mathbf{y}^\\mathsf{T}\\mathbf{y} - 2\\hat{\\boldsymbol{\\beta}}^\\mathsf{T}\\mathbf{X}^\\mathsf{T}\\mathbf{y}+\\hat{\\boldsymbol{\\beta}}^\\mathsf{T}\\mathbf{X}^\\mathsf{T}\\mathbf{X}\\hat{\\boldsymbol{\\beta}}\\\\[5pt]\n& = \\mathbf{y}^\\mathsf{T}\\mathbf{y} - \\hat{\\boldsymbol{\\beta}}^\\mathsf{T}\\mathbf{X}^\\mathsf{T}\\mathbf{y} \n\\end{aligned}\n$$\n\na\\. Explain how $-\\mathbf{y}^\\mathsf{T}\\mathbf{X}\\boldsymbol{\\beta} - \\boldsymbol{\\beta}^\\mathsf{T}\\mathbf{X}^\\mathsf{T}\\mathbf{y}$ is simplified to $-2\\boldsymbol{\\beta}^\\mathsf{T}\\mathbf{X}^\\mathsf{T}\\mathbf{y}$ when going from lines 2 to\n\nb\\. Explain how we know $\\hat{\\boldsymbol{\\beta}}^\\mathsf{T}\\mathbf{X}^\\mathsf{T}\\mathbf{y} = \\hat{\\boldsymbol{\\beta}}^\\mathsf{T}\\mathbf{X}^\\mathsf{T}\\mathbf{X}\\hat{\\boldsymbol{\\beta}}$ when going from lines 3 to 4.\n\n::: callout-important\n# Submission\n\nTo submit the AE:\n\nRender the document to produce the PDF with all of your work from today's class.\n\nPush all your work on GitHub. You're done! 🎉\n\nThere is no Gradescope submission for this lab.\n:::\n",
    "supporting": [
      "lab-04-draft_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}