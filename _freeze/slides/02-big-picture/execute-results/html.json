{
  "hash": "bd34e6947d36b75fc1ec2c0eed569408",
  "result": {
    "markdown": "---\ntitle: \"The big picture\"\nsubtitle: \"Analyzing multivariable relationships + Reproducibility\"\nauthor: \"Prof. Maria Tackett\"\ndate: \"2023-08-30\"\ndate-format: \"MMM DD, YYYY\"\nfooter: \"[üîó STA 210 - Fall 2023 -  Schedule](https://sta210-fa23.netlify.app/schedule)\"\nlogo: \"../images/logo.png\"\nformat: \n  revealjs:\n    theme: slides.scss\n    multiplex: false\n    transition: fade\n    slide-number: false\n    incremental: false \n    chalkboard: true\nexecute:\n  freeze: auto\n  echo: true\nknitr:\n  opts_chunk: \n    R.options:      \n    width: 200\nbibliography: references.bib\n---\n\n\n\n\n\n## Announcements {.midi}\n\n-   Resources for extra R review\n    -   [Learn R: An interactive introduction to data analysis R](https://learnr.numbat.space/) (focus on Chapters 4 - 6)\n\n    -   Duke Library Center for Data and Visualization Sciences workshops\n\n        -   R for Lunch: data wrangling with dplyr (Fri, Sep 1, 12:30 - 1:30)\n\n        -   R for Lunch: visualization with ggplot2 (Fri, Sep 8, 12:30 - 1:30)\n\n        -   See the [CDVS website](https://library.duke.edu/data/workshops) for more information and to register.\n-   Last day of in-person work for this class is Dec 7\n-   [Lecture recordings request policy](https://sta210-fa23.netlify.app/syllabus#lecture-recording-request)\n-   Readings for next week will be posted later this week\n\n# Questions from last class?\n\n## Topics\n\n-   Data analysis life cycle\n-   Reproducible data analysis\n-   Analyzing multivariable relationships\n\n------------------------------------------------------------------------\n\n![Source: [*R for Data Science*](https://r4ds.hadley.nz/) with additions from *The Art of Statistics: How to Learn from Data*.](images/02/data-analysis-life-cycle.png)\n\n------------------------------------------------------------------------\n\n![Source:[*R for Data Science*](https://r4ds.hadley.nz/)](images/02/whole-game.png)\n\n# Reproducibility\n\n## Reproducibility checklist\n\n::: question\nWhat does it mean for an analysis to be reproducible?\n:::\n\n. . .\n\n**Near term goals**:\n\n‚úîÔ∏è Can the tables and figures be exactly reproduced from the code and data?\n\n‚úîÔ∏è Does the code actually do what you think it does?\n\n‚úîÔ∏è In addition to what was done, is it clear *why* it was done?\n\n. . .\n\n**Long term goals**:\n\n‚úîÔ∏è Can the code be used for other data?\n\n‚úîÔ∏è Can you extend the code to do other things?\n\n## Why is reproducibility important?\n\n-   Results produced are more reliable and trustworthy [@ostblom2022]\n\n-   Facilitates more effective collaboration [@ostblom2022]\n\n-   Contributing to science, which builds and organizes knowledge in terms of testable hypotheses [@alexander2023]\n\n-   Possible to identify and correct errors or biases in the analysis process [@alexander2023]\n\n## When things go wrong {.smallest}\n\n| Reproducibility error                                    | Consequence                                          | Source(s)                                                                                                       |\n|----------------------------------------------------------|------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------|\n| Limitations in Excel data formats                        | Loss of 16,000 COVID case records in the UK          | ([Kelion 2020](https://www.bbc.com/news/technology-54423988))                                                   |\n| Automatic formatting in Excel                            | Important genes disregarded in scientific studies    | ([Ziemann, Eren, and El-Osta 2016](https://genomebiology.biomedcentral.com/articles/10.1186/s13059-016-1044-7)) |\n| Deletion of a cell caused rows to shift                  | Mix-up of which patient group received the treatment | ([Wallensteen et al. 2018](https://pubmed.ncbi.nlm.nih.gov/27373757/))                                          |\n| Using binary instead of explanatory labels               | Mix-up of the intervention with the control group    | ([Aboumatar and Wise 2019](https://jamanetwork.com/journals/jama/fullarticle/2752474))                          |\n| Using the same notation for missing data and zero values | Paper retraction                                     | ([Whitehouse et al. 2021](https://www.nature.com/articles/s41586-021-03656-3))                                  |\n| Incorrectly copying data in a spreadsheet                | Delay in the opening of a hospital                   | ([Picken 2020](https://www.bbc.com/news/uk-scotland-edinburgh-east-fife-53893101))                              |\n\nSource: @ostblom2022\n\n## Toolkit\n\n-   **Scriptability** $\\rightarrow$ R\n\n-   **Literate programming** (code, narrative, output in one place) $\\rightarrow$ Quarto\n\n-   **Version control** $\\rightarrow$ Git / GitHub\n\n::: callout-note\nYou will start using these computing tools in Lab 01.\n:::\n\n## R and RStudio\n\n-   R is a statistical programming language\n\n-   RStudio is a convenient interface for R (an integrated development environment, IDE)\n\n![Source: [Statistical Inference via Data Science](https://moderndive.com/1-getting-started.html)](images/03/r_vs_rstudio_1.png){fig-align=\"center\"}\n\n------------------------------------------------------------------------\n\n## RStudio IDE\n\n![](images/02/rstudio-panes.png){fig-align=\"center\"}\n\n------------------------------------------------------------------------\n\n## Quarto\n\n-   Fully reproducible reports -- the analysis is run from the beginning each time you render\n\n-   Code goes in chunks and narrative goes outside of chunks\n\n-   Visual editor to make document editing experience similar to a word processor (Google docs, Word, Pages, etc.)\n\n## Quarto\n\n![](images/03/quarto.png){fig-align=\"center\"}\n\n## How will we use Quarto?\n\n-   Every application exercise and assignment is written in a Quarto document\n\n-   You'll have a template Quarto document to start with\n\n-   The amount of scaffolding in the template will decrease over the semester\n\n# Version control with git and GitHub\n\n## What is versioning?\n\n<br>\n\n![](images/02/lego-steps.png){fig-align=\"center\"}\n\n------------------------------------------------------------------------\n\n## What is versioning?\n\nwith human readable messages\n\n![](images/02/lego-steps-commit-messages.png){fig-align=\"center\"}\n\n------------------------------------------------------------------------\n\n## Why do we need version control?\n\n::: columns\n::: {.column width=\"50%\"}\n![](images/02/phd_comics_vc.gif){fig-align=\"center\"}\n:::\n\n::: {.column width=\"50%\"}\nProvides a clear record of how the analysis methods evolved. This makes analysis auditable and thus more trustworthy and reliable. [@ostblom2022]\n:::\n:::\n\n## git and GitHub\n\n![](images/02/git-github.png){fig-align=\"center\"}\n\n-   **git** is a version control system -- like \"Track Changes\" features from Microsoft Word.\n-   **GitHub** is the home for your git-based projects on the internet (like DropBox but much better).\n-   There are a lot of git commands and very few people know them all. 99% of the time you will use git to add, commit, push, and pull.\n\n# Multivariable relationships\n\n## Carbohydrates in Starbucks food\n\n-   Starbucks often displays the total calories in their food items but not the other nutritional information.\n\n-   Carbohydrates are a body's main fuel source. The Dietary Guidelines for America recommend that carbohydrates make up 45% to 65% of total daily calories.[^1]\n\n-   Our goal is to understand the relationship between the amount of carbohydrates and calories in Starbucks food items. We'd also like to assess if the relationship differs based on the type of food item (bakery, salad, sandwich, etc.)\n\n[^1]: Source: [Mayo Clinic](https://www.mayoclinic.org/healthy-lifestyle/nutrition-and-healthy-eating/in-depth/carbohydrates/art-20045705#:~:text=How%20many%20carbohydrates%20do%20you,grams%20of%20carbs%20a%20day.)\n\n------------------------------------------------------------------------\n\n## Starbucks data\n\n<!-- change example, or at a minimum change bakery labels to \"bakery vs. not bakery\" instead of 0 and 1.-->\n\n\n\n::: {.cell layout-align=\"center\"}\n\n:::\n\n\n\n-   **Observations**: 77 Starbucks food items\n-   **Variables:**\n    -   `carb`: Total carbohydrates (in grams)\n    -   `calories`: Total calories\n    -   `bakery`: 1: bakery food item, 0: other food type\n\n## Terminology\n\n-   `carb` is the **response variable**\n    -   variable whose variation we want to understand / variable we wish to predict\n    -   also known as *outcome* or *dependent* variable\n\n. . .\n\n-   `calories`, `bakery` are the **predictor variables**\n    -   variables used to account for variation in the response\n    -   also known as *explanatory*, *independent*, or *input* variables\n\n## Univariate exploratory data analysis\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output .cell-output-stderr}\n```\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n```\n:::\n\n::: {.cell-output-display}\n![](02-big-picture_files/figure-html/univariate-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n\n## Bivariate exploratory data analysis\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](02-big-picture_files/figure-html/bivariate-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n\n## Function between response and predictors\n\n::: goal\n$$\\text{carb} = f(\\text{calories}, \\text{bakery}) + \\epsilon$$\n:::\n\n-   **Goal**: Determine $f$\n-   How do we determine $f$?\n    -   Make an assumption about the functional form $f$ (parametric model)\n    -   Use the data to fit a model based on that form\n\n## Determine $f$\n\n1)  Choose the functional form of $f$, i.e., **choose the appropriate model given the response variable**\n\n-   Suppose $f$ takes the form of a linear model\\\n    $$y = f(\\mathbf{X}) = \\beta_0 + \\beta_1 x_1 + \\dots + \\beta_p x_p + \\epsilon$$\n\n. . .\n\n2.  Use the data to fit (or train) the model, i.e, **estimate the model parameters,** $\\beta_0, \\beta_1, \\ldots, \\beta_p$\n\n## Carb vs. Calories\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](02-big-picture_files/figure-html/unnamed-chunk-2-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n\n$$\\text{carb} = \\beta_0 + \\beta_1 ~\\text{calories} + \\epsilon$$\n\n------------------------------------------------------------------------\n\n## Carb vs. Calories + Bakery\n\n\n\n::: {.cell layout-align=\"center\"}\n\n:::\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](02-big-picture_files/figure-html/unnamed-chunk-4-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n\n$$\\text{carb} = \\beta_0 + \\beta_1 ~\\text{calories} + \\beta_2 ~\\text{bakery} + \\epsilon$$\n\n## Carb vs. Calories + Bakery (with interaction)\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](02-big-picture_files/figure-html/unnamed-chunk-5-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n\n$${\\small \\text{carb} = \\beta_0 + \\beta_1 ~\\text{calories} + \\beta_2 ~\\text{bakery} + \\beta_3 ~ \\text{calories} \\times \\text{bakery}  + \\epsilon}$$\n\n## Statistical model vs. regression equation {.midi}\n\n**Statistical model (also known as data-generating model)**\n\n$${\\small \\text{carb} = \\beta_0 + \\beta_1 ~\\text{calories} + \\beta_2 ~\\text{bakery} + \\beta_3 ~ \\text{calories} \\times \\text{bakery}  + \\epsilon}$$\n\nModels the process for generating values of the response in the population (function + error)\n\n<br>\n\n. . .\n\n**Regression equation**\n\nEstimate of the function using the sample data\n\n$${\\small \\hat{\\text{carb}} = \\hat{\\beta}_0 + \\hat{\\beta}_1 ~\\text{calories} + \\hat{\\beta}_2 ~\\text{bakery} + \\hat{\\beta}_3 ~ \\text{calories} \\times \\text{bakery}}$$\n\n## Why fit a model?\n\n-   **Prediction:** Expected value of the response variable for given values of the predictor variables\n\n-   **Inference:** Conclusion about the relationship between the response and predictor variables\n\n::: question\n-   What is an example of a **prediction** question that can be answered using the model of carb vs. calories and bakery?\n\n-   What is an example of an **inference** question that can be answered using the model of carb vs. calories and bakery?\n:::\n\n# Application exercise\n\n::: appex\nüìã [sta210-fa23.netlify.app/ae/ae-02-bikeshare](https://sta210-fa23.netlify.app/ae/ae-02-bikeshare.html)\n:::\n\n## Recap {.midi}\n\n-   **Reproducibility**\n\n    -   It is best practice conduct all data analysis in a reproducible way\n\n    -   We will implement a reproducible workflow using R, Quarto, and git/GitHub\n\n<!-- -->\n\n-   **Multivariable relationships**\n\n    -   We can use exploratory data analysis to describe the relationship between two variables\n\n    -   We make an assumption about the relationship between variables when doing linear regression\n\n    -   The two main objectives for fitting a linear regression model are (1) prediction and (2) inference\n\n## References\n",
    "supporting": [
      "02-big-picture_files/figure-html"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}