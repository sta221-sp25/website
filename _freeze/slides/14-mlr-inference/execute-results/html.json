{
  "hash": "6b14893fe8d9da78058627cfc3c6d59e",
  "result": {
    "markdown": "---\ntitle: \"Inference for multiple linear regression\"\nauthor: \"Prof. Maria Tackett\"\ndate: \"2023-10-23\"\ndate-format: \"MMM DD, YYYY\"\nfooter: \"[ðŸ”— STA 210 - Fall 2023 -  Schedule](https://sta210-fa23.netlify.app/schedule)\"\nlogo: \"../images/logo.png\"\nformat: \n  revealjs:\n    theme: slides.scss\n    multiplex: false\n    transition: fade\n    slide-number: false\n    incremental: false \n    chalkboard: true\nhtml-math-method:\n  method: mathjax\n  url: \"https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js\"\nexecute:\n  freeze: auto\n  echo: true\nknitr:\n  opts_chunk: \n    R.options:      \n    width: 200\nbibliography: references.bib\n---\n\n\n\n\n\n## Announcements\n\n-   See Ed Discussion for upcoming events and internship opportunities\n\n-   Statistics Experience due Mon, Nov 20 at 11:59pm\n\n-   Prof. Tackett office hours Fridays 1:30 - 3:30pm for the rest of the semester\n\n-   Start the final project in lab this week - start thinking about the data your team wants to use\n\n## Mid-semester survey {.small}\n\n***Thank you to everyone who filled out the mid-semester survey!***\n\n**Aspect of class most helpful with learning**\n\n-   Application exercises\n-   Lectures\n-   Discussing content with others\n\n**Something to do in class to better help with learning**\n\n-   Zooming out more / reminder of the big picture\n-   Taking time to finish AEs (perhaps do some of this in lab)\n-   More conceptual questions on assignments, specifically HW\n\n**Things you do that are helpful with learning**\n\n-   Attend office hours!\n-   Review course materials\n-   Lots practice - review AEs, HW, labs\n\n## Mid-semester survey\n\n**Why we do in-class exams**\n\n-   Opportunity to demonstrate understanding of concepts and how they apply to application\n\n    -   This is what will make you stand out as a statistician/ data scientist!\n\n-   In-class provides the most \"level\" playing field to demonstrate conceptual understanding, given all the online resources available now\n\n-   Lots of other opportunities to demonstrate application skills through labs, HW, final project, and take-home portion of exam\n\n## Statistician of the day: Felicity Enders {.midi}\n\n::: columns\n::: {.column width=\"40%\"}\n![](images/statistician-of-the-day/enders.jpg){fig-alt=\"Photo of Dr. Felicity Enders\" fig-align=\"center\"}\n:::\n\n::: {.column width=\"60%\"}\n*Dr.Â Felicity Enders received her PhD from Johns Hopkins Bloomberg School of Public Health. She is a Professor of Biostatistics at the Mayo Clinic. With close to 200 publications, she has worked closely with clinicians, with particular focus on women's health and psychology. Across the medical spectrum, Dr.Â Enders has provided advanced statistical modeling collaboration in clinical trials.*\n\n*She is also passionate about biostatistics education and works to dissolve the hidden curriculum for research, particularly statistical knowledge needed for non-statisticians.*\n:::\n:::\n\nSource: [hardin47.github.io/CURV/scholars/enders](https://hardin47.github.io/CURV/scholars/enders.html)\n\n## Felicity Enders {.midi}\n\nDr. Enders was a statistician on an interdisciplinary research team that used logistic regression to identify demographic, clinical, and laboratory variables associated with the presence (or absence) of advanced fibrosis with the aim to create a scoring system that could be used by clinicians.\n\n*\"Data from each of the **4 countries were randomly separated into 2/3 and 1/3 of patients for model building and model validation, respectively**. Hence, data on 480 patients were used to build a model, whereas data on 253 patients were used to validate the model.\"*\n\n*\"...cross-validation was used with 20 subgroups, so that at most 5% of the data under consideration was excluded at any one time. **By employing cross-validation, the possibility of an unusually positive or negative validation subset could be assessed.**\"*\n\nAngulo, Paul, et al. \"[The NAFLD fibrosis score: a noninvasive system that identifies liver fibrosis in patients with NAFLD](https://aasldpubs.onlinelibrary.wiley.com/doi/10.1002/hep.21496).\" *Hepatology* 45.4 (2007): 846-854.\n\n## Topics\n\n::: nonincremental\n-   Cross validation application exercise\n-   Inference for multiple linear regression\n-   Checking model conditions\n:::\n\n## Computational setup\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# load packages\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nâ”€â”€ Attaching core tidyverse packages â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ tidyverse 2.0.0 â”€â”€\nâœ” dplyr     1.1.3     âœ” readr     2.1.4\nâœ” forcats   1.0.0     âœ” stringr   1.5.0\nâœ” ggplot2   3.4.3     âœ” tibble    3.2.1\nâœ” lubridate 1.9.3     âœ” tidyr     1.3.0\nâœ” purrr     1.0.2     \nâ”€â”€ Conflicts â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ tidyverse_conflicts() â”€â”€\nâœ– dplyr::filter() masks stats::filter()\nâœ– dplyr::lag()    masks stats::lag()\nâ„¹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n:::\n\n```{.r .cell-code}\nlibrary(tidymodels)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nâ”€â”€ Attaching packages â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ tidymodels 1.1.1 â”€â”€\nâœ” broom        1.0.5     âœ” rsample      1.2.0\nâœ” dials        1.2.0     âœ” tune         1.1.2\nâœ” infer        1.0.5     âœ” workflows    1.1.3\nâœ” modeldata    1.2.0     âœ” workflowsets 1.0.1\nâœ” parsnip      1.1.1     âœ” yardstick    1.2.0\nâœ” recipes      1.0.8     \nâ”€â”€ Conflicts â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ tidymodels_conflicts() â”€â”€\nâœ– scales::discard() masks purrr::discard()\nâœ– dplyr::filter()   masks stats::filter()\nâœ– recipes::fixed()  masks stringr::fixed()\nâœ– dplyr::lag()      masks stats::lag()\nâœ– yardstick::spec() masks readr::spec()\nâœ– recipes::step()   masks stats::step()\nâ€¢ Search for functions across packages at https://www.tidymodels.org/find/\n```\n:::\n\n```{.r .cell-code}\nlibrary(patchwork)\nlibrary(knitr)\nlibrary(kableExtra)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'kableExtra'\n\nThe following object is masked from 'package:dplyr':\n\n    group_rows\n```\n:::\n\n```{.r .cell-code}\nlibrary(countdown)\nlibrary(rms)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: Hmisc\n\nAttaching package: 'Hmisc'\n\nThe following object is masked from 'package:parsnip':\n\n    translate\n\nThe following objects are masked from 'package:dplyr':\n\n    src, summarize\n\nThe following objects are masked from 'package:base':\n\n    format.pval, units\n```\n:::\n\n```{.r .cell-code}\n# set default theme and larger font size for ggplot2\nggplot2::theme_set(ggplot2::theme_bw(base_size = 20))\n```\n:::\n\n\n\n# Introduction\n\n## Data: Restaurant tips\n\nWhich variables help us predict the amount customers tip at a restaurant?\n\n\n\n::: {.cell layout-align=\"center\"}\n\n:::\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 169 Ã— 5\n     Tip Party Meal   Age    Alcohol\n   <dbl> <dbl> <chr>  <chr>  <chr>  \n 1  2.99     1 Dinner Yadult No     \n 2  2        1 Dinner Yadult No     \n 3  5        1 Dinner SenCit No     \n 4  4        3 Dinner Middle No     \n 5 10.3      2 Dinner SenCit No     \n 6  4.85     2 Dinner Middle No     \n 7  5        4 Dinner Yadult No     \n 8  4        3 Dinner Middle No     \n 9  5        2 Dinner Middle No     \n10  1.58     1 Dinner SenCit No     \n# â„¹ 159 more rows\n```\n:::\n:::\n\n\n\n## Variables\n\n**Predictors**:\n\n::: nonincremental\n-   `Party`: Number of people in the party\n-   `Meal`: Time of day (Lunch, Dinner, Late Night)\n-   `Age`: Age category of person paying the bill (Yadult, Middle, SenCit)\n-   `Alcohol`: Whether the party ordered alcohol with the meal (Yes, No)\n:::\n\n**Outcome**: `Tip`: Amount of tip\n\n## Outcome: `Tip`\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](14-mlr-inference_files/figure-html/unnamed-chunk-5-1.png){fig-align='center' width=3000}\n:::\n:::\n\n\n\n## Predictors\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](14-mlr-inference_files/figure-html/unnamed-chunk-6-1.png){fig-align='center' width=3000}\n:::\n:::\n\n\n\n## Outcome vs. predictors\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](14-mlr-inference_files/figure-html/unnamed-chunk-7-1.png){fig-align='center' width=3600}\n:::\n:::\n\n\n\n## Analysis goal {.midi}\n\n::: question\nUse cross validation to evaluate and select a model to predict the tip amount\n:::\n\n. . .\n\n**v-fold cross validation** -- commonly used resampling technique:\n\n-   Randomly split your **training** **data** into ***v*** partitions\n-   Use ***v-1*** partitions for analysis, and the remaining 1 partition for assessment\n-   Repeat ***v*** times, updating which partition is used for assessment each time\n\n# Application exercise\n\n::: appex\nðŸ“‹ <https://sta210-fa23.netlify.app/ae/ae-11-cross-validation>\n:::\n\n# Inference for multiple linear regression\n\n## Modeling workflow\n\n-   Split data into training and test sets.\n\n-   Use cross validation on the training set to fit, evaluate, and compare candidate models. Choose a final model based on summary of cross validation results.\n\n-   Refit the model using the entire training set and do \"final\" evaluation on the test set (make sure you have not overfit the model).\n\n    -   Adjust as needed if there is evidence of overfit.\n\n-   Use model fit on training set for inference and prediction.\n\n## Data: `rail_trail` {.smaller}\n\n::: nonincremental\n-   The Pioneer Valley Planning Commission (PVPC) collected data for ninety days from April 5, 2005 to November 15, 2005.\n-   Data collectors set up a laser sensor, with breaks in the laser beam recording when a rail-trail user passed the data collection station.\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output .cell-output-stderr}\n```\nRows: 90 Columns: 7\nâ”€â”€ Column specification â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\nDelimiter: \",\"\nchr (2): season, day_type\ndbl (5): volume, hightemp, avgtemp, cloudcover, precip\n\nâ„¹ Use `spec()` to retrieve the full column specification for this data.\nâ„¹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 90 Ã— 7\n   volume hightemp avgtemp season cloudcover precip day_type\n    <dbl>    <dbl>   <dbl> <chr>       <dbl>  <dbl> <chr>   \n 1    501       83    66.5 Summer       7.60 0      Weekday \n 2    419       73    61   Summer       6.30 0.290  Weekday \n 3    397       74    63   Spring       7.5  0.320  Weekday \n 4    385       95    78   Summer       2.60 0      Weekend \n 5    200       44    48   Spring      10    0.140  Weekday \n 6    375       69    61.5 Spring       6.60 0.0200 Weekday \n 7    417       66    52.5 Spring       2.40 0      Weekday \n 8    629       66    52   Spring       0    0      Weekend \n 9    533       80    67.5 Summer       3.80 0      Weekend \n10    547       79    62   Summer       4.10 0      Weekday \n# â„¹ 80 more rows\n```\n:::\n:::\n\n\n\nSource: [Pioneer Valley Planning Commission](http://www.fvgreenway.org/pdfs/Northampton-Bikepath-Volume-Counts%20_05_LTA.pdf) via the **mosaicData** package.\n\n## Variables {.smaller}\n\n**Outcome**:\n\n`volume` estimated number of trail users that day (number of breaks recorded)\n\n. . .\n\n**Predictors**\n\n::: nonincremental\n-   `hightemp` daily high temperature (in degrees Fahrenheit)\n-   `avgtemp` average of daily low and daily high temperature (in degrees Fahrenheit)\n-   `season` one of \"Fall\", \"Spring\", or \"Summer\"\n-   `cloudcover` measure of cloud cover (in oktas)\n-   `precip` measure of precipitation (in inches)\n-   `day_type` one of \"weekday\" or \"weekend\"\n:::\n\n# Conduct a hypothesis test for $\\beta_j$\n\n## Review: Simple linear regression (SLR)\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(rail_trail, aes(x = hightemp, y = volume)) + \n  geom_point(alpha = 0.5) +\n  geom_smooth(method = \"lm\", se = FALSE) +\n  labs(x = \"High temp (F)\", y = \"Number of riders\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](14-mlr-inference_files/figure-html/unnamed-chunk-9-1.png){fig-align='center' width=3000}\n:::\n:::\n\n\n\n## SLR model summary\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nrt_slr_fit <- linear_reg() |>\n  set_engine(\"lm\") |>\n  fit(volume ~ hightemp, data = rail_trail)\n\ntidy(rt_slr_fit) |> kable(digits = 2)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> term </th>\n   <th style=\"text-align:right;\"> estimate </th>\n   <th style=\"text-align:right;\"> std.error </th>\n   <th style=\"text-align:right;\"> statistic </th>\n   <th style=\"text-align:right;\"> p.value </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> (Intercept) </td>\n   <td style=\"text-align:right;\"> -17.08 </td>\n   <td style=\"text-align:right;\"> 59.40 </td>\n   <td style=\"text-align:right;\"> -0.29 </td>\n   <td style=\"text-align:right;\"> 0.77 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> hightemp </td>\n   <td style=\"text-align:right;\"> 5.70 </td>\n   <td style=\"text-align:right;\"> 0.85 </td>\n   <td style=\"text-align:right;\"> 6.72 </td>\n   <td style=\"text-align:right;\"> 0.00 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n## SLR hypothesis test {.midi}\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> term </th>\n   <th style=\"text-align:right;\"> estimate </th>\n   <th style=\"text-align:right;\"> std.error </th>\n   <th style=\"text-align:right;\"> statistic </th>\n   <th style=\"text-align:right;\"> p.value </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> (Intercept) </td>\n   <td style=\"text-align:right;\"> -17.08 </td>\n   <td style=\"text-align:right;\"> 59.40 </td>\n   <td style=\"text-align:right;\"> -0.29 </td>\n   <td style=\"text-align:right;\"> 0.77 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> hightemp </td>\n   <td style=\"text-align:right;\"> 5.70 </td>\n   <td style=\"text-align:right;\"> 0.85 </td>\n   <td style=\"text-align:right;\"> 6.72 </td>\n   <td style=\"text-align:right;\"> 0.00 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n1.  **Set hypotheses:** $H_0: \\beta_1 = 0$ vs. $H_A: \\beta_1 \\ne 0$\n\n. . .\n\n2.  **Calculate test statistic and p-value:** The test statistic is $t= 6.72$ . The p-value is calculated using a $t$ distribution with 88 degrees of freedom. The p-value is $\\approx 0$ .\n\n. . .\n\n3.  **State the conclusion:** The p-value is small, so we reject $H_0$. The data provide strong evidence that high temperature is a helpful predictor for the number of daily riders, i.e. there is a linear relationship between high temperature and number of daily riders.\n\n## Multiple linear regression\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nrt_mlr_main_fit <- linear_reg() |>\n  set_engine(\"lm\") |>\n  fit(volume ~ hightemp + season, data = rail_trail)\n\ntidy(rt_mlr_main_fit) |> kable(digits = 2)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> term </th>\n   <th style=\"text-align:right;\"> estimate </th>\n   <th style=\"text-align:right;\"> std.error </th>\n   <th style=\"text-align:right;\"> statistic </th>\n   <th style=\"text-align:right;\"> p.value </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> (Intercept) </td>\n   <td style=\"text-align:right;\"> -125.23 </td>\n   <td style=\"text-align:right;\"> 71.66 </td>\n   <td style=\"text-align:right;\"> -1.75 </td>\n   <td style=\"text-align:right;\"> 0.08 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> hightemp </td>\n   <td style=\"text-align:right;\"> 7.54 </td>\n   <td style=\"text-align:right;\"> 1.17 </td>\n   <td style=\"text-align:right;\"> 6.43 </td>\n   <td style=\"text-align:right;\"> 0.00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> seasonSpring </td>\n   <td style=\"text-align:right;\"> 5.13 </td>\n   <td style=\"text-align:right;\"> 34.32 </td>\n   <td style=\"text-align:right;\"> 0.15 </td>\n   <td style=\"text-align:right;\"> 0.88 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> seasonSummer </td>\n   <td style=\"text-align:right;\"> -76.84 </td>\n   <td style=\"text-align:right;\"> 47.71 </td>\n   <td style=\"text-align:right;\"> -1.61 </td>\n   <td style=\"text-align:right;\"> 0.11 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n## MLR hypothesis test: hightemp {.midi}\n\n1.  **Set hypotheses:** $H_0: \\beta_{hightemp} = 0$ vs. $H_A: \\beta_{hightemp} \\ne 0$, given `season` is in the model\n\n. . .\n\n2.  **Calculate test statistic and p-value:** The test statistic is $t = 6.43$. The p-value is calculated using a $t$ distribution with 86 $(n - p - 1)$ degrees of freedom. The p-value is $\\approx 0$.\n\n. . .\n\n3.  **State the conclusion:** The p-value is small, so we reject $H_0$. The data provide strong evidence that high temperature for the day is a useful predictor in a model that already contains the season as a predictor for number of daily riders.\n\n## The model for `season = Spring` {.smaller}\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> term </th>\n   <th style=\"text-align:right;\"> estimate </th>\n   <th style=\"text-align:right;\"> std.error </th>\n   <th style=\"text-align:right;\"> statistic </th>\n   <th style=\"text-align:right;\"> p.value </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> (Intercept) </td>\n   <td style=\"text-align:right;\"> -125.23 </td>\n   <td style=\"text-align:right;\"> 71.66 </td>\n   <td style=\"text-align:right;\"> -1.75 </td>\n   <td style=\"text-align:right;\"> 0.08 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> hightemp </td>\n   <td style=\"text-align:right;\"> 7.54 </td>\n   <td style=\"text-align:right;\"> 1.17 </td>\n   <td style=\"text-align:right;\"> 6.43 </td>\n   <td style=\"text-align:right;\"> 0.00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> seasonSpring </td>\n   <td style=\"text-align:right;\"> 5.13 </td>\n   <td style=\"text-align:right;\"> 34.32 </td>\n   <td style=\"text-align:right;\"> 0.15 </td>\n   <td style=\"text-align:right;\"> 0.88 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> seasonSummer </td>\n   <td style=\"text-align:right;\"> -76.84 </td>\n   <td style=\"text-align:right;\"> 47.71 </td>\n   <td style=\"text-align:right;\"> -1.61 </td>\n   <td style=\"text-align:right;\"> 0.11 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n<br>\n\n. . .\n\n$$\n\\begin{aligned}\n\\widehat{volume} &= -125.23 + 7.54 \\times \\texttt{hightemp} + 5.13 \\times \\texttt{seasonSpring} - 76.84 \\times \\texttt{seasonSummer} \\\\\n&= -125.23 + 7.54 \\times \\texttt{hightemp} + 5.13 \\times 1 - 76.84 \\times 0 \\\\\n&= -120.10 + 7.54 \\times \\texttt{hightemp}\n\\end{aligned}\n$$\n\n## The model for `season = Summer` {.smaller}\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> term </th>\n   <th style=\"text-align:right;\"> estimate </th>\n   <th style=\"text-align:right;\"> std.error </th>\n   <th style=\"text-align:right;\"> statistic </th>\n   <th style=\"text-align:right;\"> p.value </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> (Intercept) </td>\n   <td style=\"text-align:right;\"> -125.23 </td>\n   <td style=\"text-align:right;\"> 71.66 </td>\n   <td style=\"text-align:right;\"> -1.75 </td>\n   <td style=\"text-align:right;\"> 0.08 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> hightemp </td>\n   <td style=\"text-align:right;\"> 7.54 </td>\n   <td style=\"text-align:right;\"> 1.17 </td>\n   <td style=\"text-align:right;\"> 6.43 </td>\n   <td style=\"text-align:right;\"> 0.00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> seasonSpring </td>\n   <td style=\"text-align:right;\"> 5.13 </td>\n   <td style=\"text-align:right;\"> 34.32 </td>\n   <td style=\"text-align:right;\"> 0.15 </td>\n   <td style=\"text-align:right;\"> 0.88 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> seasonSummer </td>\n   <td style=\"text-align:right;\"> -76.84 </td>\n   <td style=\"text-align:right;\"> 47.71 </td>\n   <td style=\"text-align:right;\"> -1.61 </td>\n   <td style=\"text-align:right;\"> 0.11 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n<br>\n\n. . .\n\n$$\n\\begin{aligned}\n\\widehat{volume} &= -125.23 + 7.54 \\times \\texttt{hightemp} + 5.13 \\times \\texttt{seasonSpring} - 76.84 \\times \\texttt{seasonSummer} \\\\\n&= -125.23 + 7.54 \\times \\texttt{hightemp} + 5.13 \\times 0 - 76.84 \\times 1 \\\\\n&= -202.07 + 7.54 \\times \\texttt{hightemp}\n\\end{aligned}\n$$\n\n## The model for `season = Fall` {.smaller}\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> term </th>\n   <th style=\"text-align:right;\"> estimate </th>\n   <th style=\"text-align:right;\"> std.error </th>\n   <th style=\"text-align:right;\"> statistic </th>\n   <th style=\"text-align:right;\"> p.value </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> (Intercept) </td>\n   <td style=\"text-align:right;\"> -125.23 </td>\n   <td style=\"text-align:right;\"> 71.66 </td>\n   <td style=\"text-align:right;\"> -1.75 </td>\n   <td style=\"text-align:right;\"> 0.08 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> hightemp </td>\n   <td style=\"text-align:right;\"> 7.54 </td>\n   <td style=\"text-align:right;\"> 1.17 </td>\n   <td style=\"text-align:right;\"> 6.43 </td>\n   <td style=\"text-align:right;\"> 0.00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> seasonSpring </td>\n   <td style=\"text-align:right;\"> 5.13 </td>\n   <td style=\"text-align:right;\"> 34.32 </td>\n   <td style=\"text-align:right;\"> 0.15 </td>\n   <td style=\"text-align:right;\"> 0.88 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> seasonSummer </td>\n   <td style=\"text-align:right;\"> -76.84 </td>\n   <td style=\"text-align:right;\"> 47.71 </td>\n   <td style=\"text-align:right;\"> -1.61 </td>\n   <td style=\"text-align:right;\"> 0.11 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n<br>\n\n. . .\n\n$$\n\\begin{aligned}\n\\widehat{volume} &= -125.23 + 7.54 \\times \\texttt{hightemp} + 5.13 \\times \\texttt{seasonSpring} - 76.84 \\times \\texttt{seasonSummer} \\\\\n&= -125.23 + 7.54 \\times \\texttt{hightemp} + 5.13 \\times 0 - 76.84 \\times 0 \\\\\n&= -125.23 + 7.54 \\times \\texttt{hightemp}\n\\end{aligned}\n$$\n\n## The models\n\nSame slope, different intercepts\n\n-   `season = Spring`: $-120.10 + 7.54 \\times \\texttt{hightemp}$\n-   `season = Summer`: $-202.07 + 7.54 \\times \\texttt{hightemp}$\n-   `season = Fall`: $-125.23 + 7.54 \\times \\texttt{hightemp}$\n\n## Application exercise\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> term </th>\n   <th style=\"text-align:right;\"> estimate </th>\n   <th style=\"text-align:right;\"> std.error </th>\n   <th style=\"text-align:right;\"> statistic </th>\n   <th style=\"text-align:right;\"> p.value </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> (Intercept) </td>\n   <td style=\"text-align:right;\"> -10.53 </td>\n   <td style=\"text-align:right;\"> 166.80 </td>\n   <td style=\"text-align:right;\"> -0.06 </td>\n   <td style=\"text-align:right;\"> 0.95 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> hightemp </td>\n   <td style=\"text-align:right;\"> 5.48 </td>\n   <td style=\"text-align:right;\"> 2.95 </td>\n   <td style=\"text-align:right;\"> 1.86 </td>\n   <td style=\"text-align:right;\"> 0.07 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> seasonSpring </td>\n   <td style=\"text-align:right;\"> -293.95 </td>\n   <td style=\"text-align:right;\"> 190.33 </td>\n   <td style=\"text-align:right;\"> -1.54 </td>\n   <td style=\"text-align:right;\"> 0.13 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> seasonSummer </td>\n   <td style=\"text-align:right;\"> 354.18 </td>\n   <td style=\"text-align:right;\"> 255.08 </td>\n   <td style=\"text-align:right;\"> 1.39 </td>\n   <td style=\"text-align:right;\"> 0.17 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> hightemp:seasonSpring </td>\n   <td style=\"text-align:right;\"> 4.88 </td>\n   <td style=\"text-align:right;\"> 3.26 </td>\n   <td style=\"text-align:right;\"> 1.50 </td>\n   <td style=\"text-align:right;\"> 0.14 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> hightemp:seasonSummer </td>\n   <td style=\"text-align:right;\"> -4.54 </td>\n   <td style=\"text-align:right;\"> 3.75 </td>\n   <td style=\"text-align:right;\"> -1.21 </td>\n   <td style=\"text-align:right;\"> 0.23 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n::: appex\nDo the data provide evidence of a significant interaction effect? Comment on the significance of the interaction terms.\n:::\n\n# Confidence interval for $\\beta_j$\n\n## Confidence interval for $\\beta_j$ {.midi}\n\n-   The $C%$ confidence interval for $\\beta_j$ $$\\hat{\\beta}_j \\pm t^* SE(\\hat{\\beta}_j)$$ where $t^*$ follows a $t$ distribution with $n - p - 1$ degrees of freedom.\n\n-   Generically, we are $C%$ confident that the interval LB to UB contains the population coefficient of $x_j$.\n\n-   In context, we are $C%$ confident that for every one unit increase in $x_j$, we expect $y$ to change by LB to UB units, holding all else constant.\n\n## Confidence interval for $\\beta_j$\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ntidy(rt_mlr_main_fit, conf.int = TRUE) |>\n  kable(digits= 2)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> term </th>\n   <th style=\"text-align:right;\"> estimate </th>\n   <th style=\"text-align:right;\"> std.error </th>\n   <th style=\"text-align:right;\"> statistic </th>\n   <th style=\"text-align:right;\"> p.value </th>\n   <th style=\"text-align:right;\"> conf.low </th>\n   <th style=\"text-align:right;\"> conf.high </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> (Intercept) </td>\n   <td style=\"text-align:right;\"> -125.23 </td>\n   <td style=\"text-align:right;\"> 71.66 </td>\n   <td style=\"text-align:right;\"> -1.75 </td>\n   <td style=\"text-align:right;\"> 0.08 </td>\n   <td style=\"text-align:right;\"> -267.68 </td>\n   <td style=\"text-align:right;\"> 17.22 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> hightemp </td>\n   <td style=\"text-align:right;\"> 7.54 </td>\n   <td style=\"text-align:right;\"> 1.17 </td>\n   <td style=\"text-align:right;\"> 6.43 </td>\n   <td style=\"text-align:right;\"> 0.00 </td>\n   <td style=\"text-align:right;\"> 5.21 </td>\n   <td style=\"text-align:right;\"> 9.87 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> seasonSpring </td>\n   <td style=\"text-align:right;\"> 5.13 </td>\n   <td style=\"text-align:right;\"> 34.32 </td>\n   <td style=\"text-align:right;\"> 0.15 </td>\n   <td style=\"text-align:right;\"> 0.88 </td>\n   <td style=\"text-align:right;\"> -63.10 </td>\n   <td style=\"text-align:right;\"> 73.36 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> seasonSummer </td>\n   <td style=\"text-align:right;\"> -76.84 </td>\n   <td style=\"text-align:right;\"> 47.71 </td>\n   <td style=\"text-align:right;\"> -1.61 </td>\n   <td style=\"text-align:right;\"> 0.11 </td>\n   <td style=\"text-align:right;\"> -171.68 </td>\n   <td style=\"text-align:right;\"> 18.00 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n## CI for `hightemp` {.midi}\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> term </th>\n   <th style=\"text-align:right;\"> estimate </th>\n   <th style=\"text-align:right;\"> std.error </th>\n   <th style=\"text-align:right;\"> statistic </th>\n   <th style=\"text-align:right;\"> p.value </th>\n   <th style=\"text-align:right;\"> conf.low </th>\n   <th style=\"text-align:right;\"> conf.high </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> (Intercept) </td>\n   <td style=\"text-align:right;\"> -125.23 </td>\n   <td style=\"text-align:right;\"> 71.66 </td>\n   <td style=\"text-align:right;\"> -1.75 </td>\n   <td style=\"text-align:right;\"> 0.08 </td>\n   <td style=\"text-align:right;\"> -267.68 </td>\n   <td style=\"text-align:right;\"> 17.22 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> hightemp </td>\n   <td style=\"text-align:right;\"> 7.54 </td>\n   <td style=\"text-align:right;\"> 1.17 </td>\n   <td style=\"text-align:right;\"> 6.43 </td>\n   <td style=\"text-align:right;\"> 0.00 </td>\n   <td style=\"text-align:right;\"> 5.21 </td>\n   <td style=\"text-align:right;\"> 9.87 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> seasonSpring </td>\n   <td style=\"text-align:right;\"> 5.13 </td>\n   <td style=\"text-align:right;\"> 34.32 </td>\n   <td style=\"text-align:right;\"> 0.15 </td>\n   <td style=\"text-align:right;\"> 0.88 </td>\n   <td style=\"text-align:right;\"> -63.10 </td>\n   <td style=\"text-align:right;\"> 73.36 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> seasonSummer </td>\n   <td style=\"text-align:right;\"> -76.84 </td>\n   <td style=\"text-align:right;\"> 47.71 </td>\n   <td style=\"text-align:right;\"> -1.61 </td>\n   <td style=\"text-align:right;\"> 0.11 </td>\n   <td style=\"text-align:right;\"> -171.68 </td>\n   <td style=\"text-align:right;\"> 18.00 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n<br>\n\nWe are 95% confident that for every degree Fahrenheit the day is warmer, the number of riders increases by 5.21 to 9.87, on average, holding season constant.\n\n## CI for `seasonSpring` {.midi}\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> term </th>\n   <th style=\"text-align:right;\"> estimate </th>\n   <th style=\"text-align:right;\"> std.error </th>\n   <th style=\"text-align:right;\"> statistic </th>\n   <th style=\"text-align:right;\"> p.value </th>\n   <th style=\"text-align:right;\"> conf.low </th>\n   <th style=\"text-align:right;\"> conf.high </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> (Intercept) </td>\n   <td style=\"text-align:right;\"> -125.23 </td>\n   <td style=\"text-align:right;\"> 71.66 </td>\n   <td style=\"text-align:right;\"> -1.75 </td>\n   <td style=\"text-align:right;\"> 0.08 </td>\n   <td style=\"text-align:right;\"> -267.68 </td>\n   <td style=\"text-align:right;\"> 17.22 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> hightemp </td>\n   <td style=\"text-align:right;\"> 7.54 </td>\n   <td style=\"text-align:right;\"> 1.17 </td>\n   <td style=\"text-align:right;\"> 6.43 </td>\n   <td style=\"text-align:right;\"> 0.00 </td>\n   <td style=\"text-align:right;\"> 5.21 </td>\n   <td style=\"text-align:right;\"> 9.87 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> seasonSpring </td>\n   <td style=\"text-align:right;\"> 5.13 </td>\n   <td style=\"text-align:right;\"> 34.32 </td>\n   <td style=\"text-align:right;\"> 0.15 </td>\n   <td style=\"text-align:right;\"> 0.88 </td>\n   <td style=\"text-align:right;\"> -63.10 </td>\n   <td style=\"text-align:right;\"> 73.36 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> seasonSummer </td>\n   <td style=\"text-align:right;\"> -76.84 </td>\n   <td style=\"text-align:right;\"> 47.71 </td>\n   <td style=\"text-align:right;\"> -1.61 </td>\n   <td style=\"text-align:right;\"> 0.11 </td>\n   <td style=\"text-align:right;\"> -171.68 </td>\n   <td style=\"text-align:right;\"> 18.00 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n<br>\n\nWe are 95% confident that the number of riders on a Spring day is lower by 63.1 to higher by 73.4 compared to a Fall day, on average, holding high temperature for the day constant.\n\n. . .\n\n::: question\nIs `season` a significant predictor of the number of riders, after accounting for high temperature?\n:::\n\n# Inference pitfalls\n\n## Large sample sizes\n\n::: callout-caution\nIf the sample size is large enough, the test will likely result in rejecting $H_0: \\beta_j = 0$ even $x_j$ has a very small effect on $y$.\n\n::: nonincremental\n-   Consider the **practical significance** of the result not just the statistical significance.\n\n-   Use the confidence interval to draw conclusions instead of relying only p-values.\n:::\n:::\n\n## Small sample sizes\n\n::: callout-caution\nIf the sample size is small, there may not be enough evidence to reject $H_0: \\beta_j=0$.\n\n::: nonincremental\n-   When you fail to reject the null hypothesis, **DON'T** immediately conclude that the variable has no association with the response.\n\n-   There may be a linear association that is just not strong enough to detect given your data, or there may be a non-linear association.\n:::\n:::\n\n# Conditions for inference\n\n## Full model {.smaller}\n\nIncluding all available predictors\n\n**Fit:**\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nrt_full_fit <- linear_reg() |>\n  set_engine(\"lm\") |>\n  fit(volume ~ ., data = rail_trail)\n```\n:::\n\n\n\n. . .\n\n**Summarize:**\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ntidy(rt_full_fit)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 8 Ã— 5\n  term            estimate std.error statistic p.value\n  <chr>              <dbl>     <dbl>     <dbl>   <dbl>\n1 (Intercept)        17.6      76.6      0.230 0.819  \n2 hightemp            7.07      2.42     2.92  0.00450\n3 avgtemp            -2.04      3.14    -0.648 0.519  \n4 seasonSpring       35.9      33.0      1.09  0.280  \n5 seasonSummer       24.2      52.8      0.457 0.649  \n6 cloudcover         -7.25      3.84    -1.89  0.0627 \n7 precip            -95.7      42.6     -2.25  0.0273 \n8 day_typeWeekend    35.9      22.4      1.60  0.113  \n```\n:::\n:::\n\n\n\n. . .\n\n**Augment:**\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nrt_full_aug <- augment(rt_full_fit$fit)\n```\n:::\n\n\n\n## Model conditions\n\n1.  **Linearity:** There is a linear relationship between the response and predictor variables.\n\n2.  **Constant Variance:** The variability about the least squares line is generally constant.\n\n3.  **Normality:** The distribution of the residuals is approximately normal.\n\n4.  **Independence:** The residuals are independent from each other.\n\n## Residuals vs. predicted values\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(data = rt_full_aug, aes(x = .fitted, y = .resid)) +\n  geom_point(alpha = 0.7) +\n  geom_hline(yintercept = 0, color = \"red\", linetype = \"dashed\") +\n  labs(x = \"Predicted values\", y = \"Residuals\")\n```\n\n::: {.cell-output-display}\n![](14-mlr-inference_files/figure-html/main_res_pred-1.png){fig-align='center' width=3000}\n:::\n:::\n\n\n\n## Linearity: Residuals vs. predicted\n\n::: question\nDoes the linearity condition appear to be met?\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](14-mlr-inference_files/figure-html/unnamed-chunk-24-1.png){fig-align='center' width=3000}\n:::\n:::\n\n\n\n## Linearity: Residuals vs. predicted\n\nLook at individual plots of residuals vs. each predictor, particularly if there are potential issues in the plot of residuals vs. predicted values.\n\n## Linearity: Residuals vs. each predictor\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](14-mlr-inference_files/figure-html/unnamed-chunk-25-1.png){fig-align='center' width=3000}\n:::\n:::\n\n\n\n## Checking linearity\n\n-   The plots of residuals vs. `hightemp` and `avgtemp` appear to have a parabolic pattern.\n\n-   The linearity condition is not satisfied given these plots.\n\n## Checking constant variance\n\n::: question\nDoes the constant variance condition appear to be satisfied?\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](14-mlr-inference_files/figure-html/unnamed-chunk-26-1.png){fig-align='center' width=3000}\n:::\n:::\n\n\n\n## Checking constant variance\n\n-   The vertical spread of the residuals is not constant across the plot.\n\n-   The constant variance condition is not satisfied.\n\n## Checking normality\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](14-mlr-inference_files/figure-html/unnamed-chunk-27-1.png){fig-align='center' width=3000}\n:::\n:::\n\n\n\n## Checking independence\n\n-   We can often check the independence condition based on the context of the data and how the observations were collected.\n\n-   If the data were collected in a particular order, examine a scatterplot of the residuals versus order in which the data were collected.\n\n-   If there is a grouping variable lurking in the background, check the residuals based on that grouping variable.\n\n## Checking independence {.midi}\n\nResiduals vs. order of data collection:\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(rt_full_aug, aes(y = .resid, x = 1:nrow(rt_full_aug))) +\n  geom_point() +\n  geom_hline(yintercept = 0, color = \"red\", linetype = \"dashed\") +\n  labs(x = \"Order of data collection\", y = \"Residuals\")\n```\n\n::: {.cell-output-display}\n![](14-mlr-inference_files/figure-html/unnamed-chunk-28-1.png){fig-align='center' width=3000}\n:::\n:::\n\n\n\n## Checking independence\n\n-   No clear pattern in the residuals vs. order of data collection plot.\n\n-   Independence condition appears to be satisfied, as far as we can evaluate it.\n\n# Multicollinearity\n\n## Why multicollinearity is a problem\n\n-   We can't include two variables that have a perfect linear association with each other\n\n-   If we did so, we could not find unique estimates for the model coefficients\n\n## Example\n\nSuppose the true population regression equation is $y = 3 + 4x$\n\n-   Suppose we try estimating that equation using a model with variables $x$ and $z = x/10$\n\n$$\n\\begin{aligned}\\hat{y}&= \\hat{\\beta}_0 + \\hat{\\beta}_1x  + \\hat{\\beta}_2z\\\\\n&= \\hat{\\beta}_0 + \\hat{\\beta}_1x  + \\hat{\\beta}_2\\frac{x}{10}\\\\\n&= \\hat{\\beta}_0 + \\bigg(\\hat{\\beta}_1 + \\frac{\\hat{\\beta}_2}{10}\\bigg)x\n\\end{aligned}\n$$\n\n## Example\n\n$$\\hat{y} = \\hat{\\beta}_0 + \\bigg(\\hat{\\beta}_1 + \\frac{\\hat{\\beta}_2}{10}\\bigg)x$$\n\n-   We can set $\\hat{\\beta}_1$ and $\\hat{\\beta}_2$ to any two numbers such that $\\hat{\\beta}_1 + \\frac{\\hat{\\beta}_2}{10} = 4$\n\n-   Therefore, we are unable to choose the \"best\" combination of $\\hat{\\beta}_1$ and $\\hat{\\beta}_2$\n\n## Why multicollinearity is a problem\n\n-   When we have almost perfect collinearities (i.e. highly correlated predictor variables), the standard errors for our regression coefficients inflate\n\n-   In other words, we lose precision in our estimates of the regression coefficients\n\n-   This impedes our ability to use the model for inference or prediction\n\n## Detecting Multicollinearity {.midi}\n\nMulticollinearity may occur when...\n\n-   There are very high correlations $(r > 0.9)$ among two or more predictor variables, especially when the sample size is small\n\n<!-- -->\n\n-   One (or more) predictor variables is an almost perfect linear combination of the others\n\n-   Include a quadratic in the model mean-centering the variable first\n\n-   Including interactions between two or more continuous variables\n\n## Detecting multicollinearity in the EDA\n\n-   Look at a correlation matrix of the predictor variables, including all indicator variables\n    -   Look out for values close to 1 or -1\n-   Look at a scatterplot matrix of the predictor variables\n    -   Look out for plots that show a relatively linear relationship\n\n## Detecting Multicollinearity (VIF)\n\n**Variance Inflation Factor (VIF)**: Measure of multicollinearity in the regression model\n\n$$VIF(\\hat{\\beta}_j) = \\frac{1}{1-R^2_{X_j|X_{-j}}}$$\n\nwhere $R^2_{X_j|X_{-j}}$ is the proportion of variation $X$ that is explained by the linear combination of the other explanatory variables in the model.\n\n## Detecting Multicollinearity (VIF)\n\nTypically $VIF > 10$ indicates concerning multicollinearity - Variables with similar values of VIF are typically the ones correlated with each other\n\n<br>\n\nUse the `vif()` function in the **rms** R package to calculate VIF\n\n## VIF for rail trail model\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nvif(rt_full_fit$fit)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n       hightemp         avgtemp    seasonSpring    seasonSummer      cloudcover \n      10.259978       13.086175        2.751577        5.841985        1.587485 \n         precip day_typeWeekend \n       1.295352        1.125741 \n```\n:::\n:::\n\n\n\n<br>\n\n. . .\n\n`hightemp` and `avgtemp` are correlated. We need to remove <u>**one**</u> of these variables and refit the model.\n\n## Model without `hightemp` {.smaller}\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nm1 <- linear_reg() |>\n  set_engine(\"lm\") |>\n  fit(volume ~ . - hightemp, data = rail_trail)\n  \nm1 |>\n  tidy() |>\n  kable(digits = 3)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> term </th>\n   <th style=\"text-align:right;\"> estimate </th>\n   <th style=\"text-align:right;\"> std.error </th>\n   <th style=\"text-align:right;\"> statistic </th>\n   <th style=\"text-align:right;\"> p.value </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> (Intercept) </td>\n   <td style=\"text-align:right;\"> 76.071 </td>\n   <td style=\"text-align:right;\"> 77.204 </td>\n   <td style=\"text-align:right;\"> 0.985 </td>\n   <td style=\"text-align:right;\"> 0.327 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> avgtemp </td>\n   <td style=\"text-align:right;\"> 6.003 </td>\n   <td style=\"text-align:right;\"> 1.583 </td>\n   <td style=\"text-align:right;\"> 3.792 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> seasonSpring </td>\n   <td style=\"text-align:right;\"> 34.555 </td>\n   <td style=\"text-align:right;\"> 34.454 </td>\n   <td style=\"text-align:right;\"> 1.003 </td>\n   <td style=\"text-align:right;\"> 0.319 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> seasonSummer </td>\n   <td style=\"text-align:right;\"> 13.531 </td>\n   <td style=\"text-align:right;\"> 55.024 </td>\n   <td style=\"text-align:right;\"> 0.246 </td>\n   <td style=\"text-align:right;\"> 0.806 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> cloudcover </td>\n   <td style=\"text-align:right;\"> -12.807 </td>\n   <td style=\"text-align:right;\"> 3.488 </td>\n   <td style=\"text-align:right;\"> -3.672 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> precip </td>\n   <td style=\"text-align:right;\"> -110.736 </td>\n   <td style=\"text-align:right;\"> 44.137 </td>\n   <td style=\"text-align:right;\"> -2.509 </td>\n   <td style=\"text-align:right;\"> 0.014 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> day_typeWeekend </td>\n   <td style=\"text-align:right;\"> 48.420 </td>\n   <td style=\"text-align:right;\"> 22.993 </td>\n   <td style=\"text-align:right;\"> 2.106 </td>\n   <td style=\"text-align:right;\"> 0.038 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n## Model without `avgtemp` {.smaller}\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nm2 <- linear_reg() |>\n  set_engine(\"lm\") |>\n  fit(volume ~ . - avgtemp, data = rail_trail)\n  \nm2 |>\n  tidy() |>\n  kable(digits = 3)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> term </th>\n   <th style=\"text-align:right;\"> estimate </th>\n   <th style=\"text-align:right;\"> std.error </th>\n   <th style=\"text-align:right;\"> statistic </th>\n   <th style=\"text-align:right;\"> p.value </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> (Intercept) </td>\n   <td style=\"text-align:right;\"> 8.421 </td>\n   <td style=\"text-align:right;\"> 74.992 </td>\n   <td style=\"text-align:right;\"> 0.112 </td>\n   <td style=\"text-align:right;\"> 0.911 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> hightemp </td>\n   <td style=\"text-align:right;\"> 5.696 </td>\n   <td style=\"text-align:right;\"> 1.164 </td>\n   <td style=\"text-align:right;\"> 4.895 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> seasonSpring </td>\n   <td style=\"text-align:right;\"> 31.239 </td>\n   <td style=\"text-align:right;\"> 32.082 </td>\n   <td style=\"text-align:right;\"> 0.974 </td>\n   <td style=\"text-align:right;\"> 0.333 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> seasonSummer </td>\n   <td style=\"text-align:right;\"> 9.424 </td>\n   <td style=\"text-align:right;\"> 47.504 </td>\n   <td style=\"text-align:right;\"> 0.198 </td>\n   <td style=\"text-align:right;\"> 0.843 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> cloudcover </td>\n   <td style=\"text-align:right;\"> -8.353 </td>\n   <td style=\"text-align:right;\"> 3.435 </td>\n   <td style=\"text-align:right;\"> -2.431 </td>\n   <td style=\"text-align:right;\"> 0.017 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> precip </td>\n   <td style=\"text-align:right;\"> -98.904 </td>\n   <td style=\"text-align:right;\"> 42.137 </td>\n   <td style=\"text-align:right;\"> -2.347 </td>\n   <td style=\"text-align:right;\"> 0.021 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> day_typeWeekend </td>\n   <td style=\"text-align:right;\"> 37.062 </td>\n   <td style=\"text-align:right;\"> 22.280 </td>\n   <td style=\"text-align:right;\"> 1.663 </td>\n   <td style=\"text-align:right;\"> 0.100 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n## Choosing a model {.midi}\n\nModel without **hightemp**:\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> adj.r.squared </th>\n   <th style=\"text-align:right;\"> AIC </th>\n   <th style=\"text-align:right;\"> BIC </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 0.42 </td>\n   <td style=\"text-align:right;\"> 1087.5 </td>\n   <td style=\"text-align:right;\"> 1107.5 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\nModel without **avgtemp**:\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> adj.r.squared </th>\n   <th style=\"text-align:right;\"> AIC </th>\n   <th style=\"text-align:right;\"> BIC </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 0.47 </td>\n   <td style=\"text-align:right;\"> 1079.05 </td>\n   <td style=\"text-align:right;\"> 1099.05 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\nBased on Adjusted $R^2$, AIC, and BIC, the model without **avgtemp** is a better fit. Therefore, we choose to remove **avgtemp** from the model and leave **hightemp** in the model to deal with the multicollinearity.\n\n## Final model\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> term </th>\n   <th style=\"text-align:right;\"> estimate </th>\n   <th style=\"text-align:right;\"> std.error </th>\n   <th style=\"text-align:right;\"> statistic </th>\n   <th style=\"text-align:right;\"> p.value </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> (Intercept) </td>\n   <td style=\"text-align:right;\"> 8.421 </td>\n   <td style=\"text-align:right;\"> 74.992 </td>\n   <td style=\"text-align:right;\"> 0.112 </td>\n   <td style=\"text-align:right;\"> 0.911 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> hightemp </td>\n   <td style=\"text-align:right;\"> 5.696 </td>\n   <td style=\"text-align:right;\"> 1.164 </td>\n   <td style=\"text-align:right;\"> 4.895 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> seasonSpring </td>\n   <td style=\"text-align:right;\"> 31.239 </td>\n   <td style=\"text-align:right;\"> 32.082 </td>\n   <td style=\"text-align:right;\"> 0.974 </td>\n   <td style=\"text-align:right;\"> 0.333 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> seasonSummer </td>\n   <td style=\"text-align:right;\"> 9.424 </td>\n   <td style=\"text-align:right;\"> 47.504 </td>\n   <td style=\"text-align:right;\"> 0.198 </td>\n   <td style=\"text-align:right;\"> 0.843 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> cloudcover </td>\n   <td style=\"text-align:right;\"> -8.353 </td>\n   <td style=\"text-align:right;\"> 3.435 </td>\n   <td style=\"text-align:right;\"> -2.431 </td>\n   <td style=\"text-align:right;\"> 0.017 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> precip </td>\n   <td style=\"text-align:right;\"> -98.904 </td>\n   <td style=\"text-align:right;\"> 42.137 </td>\n   <td style=\"text-align:right;\"> -2.347 </td>\n   <td style=\"text-align:right;\"> 0.021 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> day_typeWeekend </td>\n   <td style=\"text-align:right;\"> 37.062 </td>\n   <td style=\"text-align:right;\"> 22.280 </td>\n   <td style=\"text-align:right;\"> 1.663 </td>\n   <td style=\"text-align:right;\"> 0.100 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n",
    "supporting": [
      "14-mlr-inference_files/figure-html"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}