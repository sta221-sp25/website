{
  "hash": "4fdb14b34b1017582a5bd453d09fb297",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Logistic Regression: Inference\"\nauthor: \"Prof. Maria Tackett\"\ndate: \"2024-11-14\"\ndate-format: \"MMM DD, YYYY\"\nfooter: \"[ðŸ”— STA 221 - Fall 2024](https://sta221-fa24.netlify.app)\"\nlogo: \"../images/logo.png\"\nformat: \n  revealjs:\n    theme: slides.scss\n    multiplex: false\n    transition: fade\n    slide-number: true\n    incremental: false \n    chalkboard: true\nhtml-math-method:\n  method: mathjax\n  url: \"https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js\"\nexecute:\n  freeze: auto\n  echo: true\nknitr:\n  opts_chunk: \n    R.options:      \n    width: 200\n    \nbibliography: references.bib\n---\n\n\n\n\n\n## Announcements {.midi}\n\n-   Project: Draft report due + peer review in December 2 lab\n\n-   Statistics experience due Tuesday, November 26\n\n-   HW 04 released later today. Due Thursday, November 21\n\n## Topics\n\n-   Test of significance for overall logistic regression model\n\n-   Test of significance for a subset of model coefficients\n\n-   Test of significance for a single coefficient\n\n## Computational setup\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(tidymodels)\nlibrary(pROC)      \nlibrary(knitr)\nlibrary(kableExtra)\n\n# set default theme in ggplot2\nggplot2::theme_set(ggplot2::theme_bw())\n```\n:::\n\n\n\n# \n\n## Risk of coronary heart disease {.midi}\n\nThis data set is from an ongoing cardiovascular study on residents of the town of Framingham, Massachusetts. We want to examine the relationship between various health characteristics and the risk of having heart disease.\n\n-   `high_risk`:\n\n    -   1: High risk of having heart disease in next 10 years\n    -   0: Not high risk of having heart disease in next 10 years\n\n-   `age`: Age at exam time (in years)\n\n-   `totChol`: Total cholesterol (in mg/dL)\n\n-   `currentSmoker`: 0 = nonsmoker, 1 = smoker\n\n-   `education`: 1 = Some High School, 2 = High School or GED, 3 = Some College or Vocational School, 4 = College\n\n\n\n::: {.cell layout-align=\"center\"}\n\n:::\n\n\n\n## Modeling risk of coronary heart disease\n\nUsing `age`, `totChol`, `currentSmoker`\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nheart_disease_fit <- glm(high_risk ~ age + totChol + currentSmoker, \n              data = heart_disease, family = \"binomial\")\n\ntidy(heart_disease_fit, conf.int = TRUE) |> \n  kable(digits = 3)\n```\n\n::: {.cell-output-display}\n\n\n|term           | estimate| std.error| statistic| p.value| conf.low| conf.high|\n|:--------------|--------:|---------:|---------:|-------:|--------:|---------:|\n|(Intercept)    |   -6.673|     0.378|   -17.647|   0.000|   -7.423|    -5.940|\n|age            |    0.082|     0.006|    14.344|   0.000|    0.071|     0.094|\n|totChol        |    0.002|     0.001|     1.940|   0.052|    0.000|     0.004|\n|currentSmoker1 |    0.443|     0.094|     4.733|   0.000|    0.260|     0.627|\n\n\n:::\n:::\n\n\n\n# Test for overall significance\n\n## Likelihood ratio test\n\nSimilar to linear regression, we can test the overall significance for a logistic regression model, i.e., whether there is at least one non-zero coefficient in the model\n\n$$\n\\begin{aligned}\n&H_0: \\beta_1 = \\dots = \\beta_p = 0 \\\\\n&H_a: \\beta_j \\neq 0 \\text{ for at least one } j\n\\end{aligned}\n$$\n\n. . .\n\nThe **likelihood ratio test** compares the fit of a model with no predictors to the current model.\n\n## Likelihood ratio test statistic\n\nLet $L_0$ and $L_a$ be the likelihood functions of the model under $H_0$ and $H_a$, respectively. The **likelihood ratio test statistic** is\n\n$$\nG = -2[\\log L_0 - \\log L_a] = -2\\sum_{i=1}^n \\Big[ y_i \\log \\Big(\\frac{\\hat{\\pi}^0}{\\hat{\\pi}^a_i}\\Big) + (1 - y_i)\\log \\Big(\\frac{1-\\hat{\\pi}^0}{1-\\hat{\\pi}^a_i}\\Big)\\Big]\n$$\n\nwhere $\\hat{\\pi}^0$ is the predicted probability under $H_0$ and $\\hat{\\pi}_i^a = \\frac{\\exp \\{x_i^T\\boldsymbol{\\beta}\\}}{1 + \\exp \\{x_i^T\\boldsymbol{\\beta}\\}}$ is the predicted probability under $H_a$ [^1]\n\n[^1]: See @wilks1935likelihood for explanation of why -2 is included.\n\n## Likelihood ratio test statistic\n\n$$\nG = -2\\sum_{i=1}^n \\Big[ y_i \\log \\Big(\\frac{\\hat{\\pi}^0}{\\hat{\\pi}^a_i}\\Big) + (1 - y_i)\\log \\Big(\\frac{1-\\hat{\\pi}^0}{1-\\hat{\\pi}^a_i}\\Big)\\Big]\n$$\n\n. . .\n\n::: incremental\n-   When $n$ is large, $G \\sim \\chi^2_p$, ( $G$ follows a Chi-square distribution with $p$ degrees of freedom)\n\n-   The p-value is calculated as $\\text{p-value} = P(\\chi^2 > G)$\n\n-   Large values of $G$ (small p-values) indicate at least one $\\beta_j$ is non-zero\n:::\n\n## $\\chi^2$ distribution\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](21-logistic-inference_files/figure-revealjs/unnamed-chunk-4-1.png){fig-align='center' width=768}\n:::\n:::\n\n\n\n## Heart disease model: likelihood ratio test\n\n$$\n\\begin{aligned}\n&H_0: \\beta_{age} = \\beta_{totChol} = \\beta_{currentSmoker} = 0 \\\\\n&H_a: \\beta_j \\neq 0 \\text{ for at least one }j\n\\end{aligned}$$\n\n. . .\n\n**Fit the null model**\n\n(we've already fit the alternative model)\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nnull_model <- glm(high_risk ~ 1, data = heart_disease, family = \"binomial\")\n\ntidy(null_model) |>\n  kable()\n```\n\n::: {.cell-output-display}\n\n\n|term        | estimate| std.error| statistic| p.value|\n|:-----------|--------:|---------:|---------:|-------:|\n|(Intercept) | -1.72294| 0.0436342|   -39.486|       0|\n\n\n:::\n:::\n\n\n\n## Heart disease model: likelihood ratio test\n\n**Calculate the log-likelihood for the null and alternative models**\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n(L_0 <- glance(null_model)$logLik)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] -1737.735\n```\n\n\n:::\n\n```{.r .cell-code}\n(L_a <- glance(heart_disease_fit)$logLik)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] -1612.406\n```\n\n\n:::\n:::\n\n\n\n. . .\n\n**Calculate the likelihood ratio test statistic**\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n(G <- -2 * (L_0 - L_a))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 250.6572\n```\n\n\n:::\n:::\n\n\n\n. . .\n\n## Heart disease model: likelihood ratio test\n\n**Calculate the p-value**\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n(p_value <- pchisq(G, df = 3, lower.tail = FALSE))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 4.717158e-54\n```\n\n\n:::\n:::\n\n\n\n. . .\n\n**Conclusion**\n\nThe p-value is small, so we reject $H_0$. The data provide evidence of at least one non-zero model coefficient in the model.\n\n# Test a subset of coefficients\n\n## Testing a subset of coefficients\n\n-   Suppose there are two models:\n\n    -   Reduced Model: includes predictors $x_1, \\ldots, x_q$\n\n    -   Full Model: includes predictors $x_1, \\ldots, x_q, x_{q+1}, \\ldots, x_p$\n\n-   We can use the likelihood ratios to see if any of the new predictors are useful\n\n. . .\n\n$$\n\\begin{aligned}\n&H_0: \\beta_{q+1} = \\dots = \\beta_p = 0\\\\\n&H_a: \\beta_j \\neq 0 \\text{ for at least one }j\n\\end{aligned}\n$$\n\n. . .\n\nThis is called a **drop-in-deviance** test (also known as nested likelihood ratio test)\n\n## Deviance {.midi}\n\nThe **deviance** is a measure of the degree to which the predicted values are different from the observed values (compares the current model to a \"saturated\" model)\n\n<br>\n\nIn logistic regression,\n\n$$\nD = -2 \\log L \n$$\n\n<br>\n\n$D \\sim \\chi^2_{n - p - 1}$ ( $D$ follows a Chi-square distribution with $n - p - 1$ degrees of freedom)\n\n<br>\n\nNote: $n - p - 1$ a the degrees of freedom associated with the error in the model (like residuals)\n\n## Drop-in-deviance test\n\n$$\n\\begin{aligned}\n&H_0: \\beta_{q+1} = \\dots = \\beta_p = 0\\\\\n&H_a: \\beta_j \\neq 0 \\text{ for at least one }j\n\\end{aligned}\n$$\n\n. . .\n\nThe test statistic is\n\n$$\n\\begin{aligned}\nG = D_{reduced} - D_{full} &= -2\\log L_{reduced} - (-2 \\log L_{full}) \\\\\n&= -2(\\log L_{reduced} - \\log L_{full})\n\\end{aligned}\n$$\n\n. . .\n\nThe p-value is calculated using a $\\chi_{\\Delta df}^2$ distribution, where $\\Delta df$ is the number of parameters being tested (the difference in number of parameters between the full and reduced model).\n\n## Heart disease model: drop-in-deviance test\n\nShould we add `education` to the model?\n\n-   Reduced model: `age`, `totChol`, `currentSmoker`\n\n-   Full model: `age`, `totChol`, `currentSmoker` , `education`\n\n. . .\n\n$$\n\\begin{aligned}\n&H_0: \\beta_{ed1} = \\beta_{ed2} = \\beta_{ed3} = 0 \\\\\n&H_a: \\beta_j \\neq 0 \\text{ for at least one }j\n\\end{aligned}\n$$\n\n## Heart disease model: drop-in-deviance test {.midi}\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nreduced_model <- glm(high_risk ~ age + totChol + currentSmoker, \n              data = heart_disease, family = \"binomial\")\n\nfull_model <- glm(high_risk ~ age + totChol + currentSmoker + education, \n              data = heart_disease, family = \"binomial\")\n```\n:::\n\n\n\n. . .\n\n**Calculate deviances**\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n(deviance_reduced <- -2 * glance(reduced_model)$logLik)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 3224.812\n```\n\n\n:::\n\n```{.r .cell-code}\n(deviance_full <- -2 * glance(full_model)$logLik)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 3217.6\n```\n\n\n:::\n:::\n\n\n\n. . .\n\n**Calculate test statistic**\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n(G <- deviance_reduced - deviance_full)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 7.212113\n```\n\n\n:::\n:::\n\n\n\n## Heart disease model: drop-in-deviance test\n\n**Calculate p-value**\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\npchisq(G, df = 3, lower.tail = FALSE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.06543567\n```\n\n\n:::\n:::\n\n\n\n<br>\n\n. . .\n\n::: question\nWhat is your conclusion? Would you include `education` in the model that already has `age`, `totChol`, `currentSmoker`?\n:::\n\n## Drop-in-deviance test in R {.midi}\n\nConduct the drop-in-deviance test using the `anova()` function in R with option `test = \"Chisq\"`\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nanova(reduced_model, full_model, test = \"Chisq\") |> \n  tidy() |> \n  kable(digits = 3)\n```\n\n::: {.cell-output-display}\n\n\n|term                                                  | df.residual| residual.deviance| df| deviance| p.value|\n|:-----------------------------------------------------|-----------:|-----------------:|--:|--------:|-------:|\n|high_risk ~ age + totChol + currentSmoker             |        4082|          3224.812| NA|       NA|      NA|\n|high_risk ~ age + totChol + currentSmoker + education |        4079|          3217.600|  3|    7.212|   0.065|\n\n\n:::\n:::\n\n\n\n## AIC and BIC\n\nSimilar to linear regression, we can use AIC and BIC to compare models.\n\n$$\n\\begin{aligned}\n&AIC = -2 \\log L + 2(p+1) \\\\\n&BIC = -2 \\log L + \\log(n)(p + 1)\n\\end{aligned}\n$$\n\nYou want to select the model that minimizes AIC / BIC\n\n## Compare models using AIC\n\nAIC for reduced model (`age`, `totChol`, `currentSmoker`)\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nglance(reduced_model)$AIC\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 3232.812\n```\n\n\n:::\n:::\n\n\n\n<br>\n\n. . .\n\nAIC for full model (`age`, `totChol`, `currentSmoker`, `education`)\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nglance(full_model)$AIC\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 3231.6\n```\n\n\n:::\n:::\n\n\n\n## Compare models using BIC\n\nBIC for reduced model (`age`, `totChol`, `currentSmoker`)\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nglance(reduced_model)$BIC\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 3258.074\n```\n\n\n:::\n:::\n\n\n\n<br>\n\n. . .\n\nBIC for full model (`age`, `totChol`, `currentSmoker`, `education`)\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nglance(full_model)$BIC\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 3275.807\n```\n\n\n:::\n:::\n\n\n\n# Test for a single coefficient\n\n## Distribution of $\\hat{\\boldsymbol{\\beta}}$\n\nWhen $n$ is large, $\\hat{\\boldsymbol{\\beta}}$, the estimated coefficients of the logistic regression model, is approximately normal.\n\n<br>\n\n::: question\nHow do we know the distribution of $\\hat{\\boldsymbol{\\beta}}$ is normal for large $n$?\n:::\n\n## Distribution of $\\hat{\\boldsymbol{\\beta}}$\n\nThe expected value of $\\hat{\\boldsymbol{\\beta}}$ is the true parameter, $\\boldsymbol{\\beta}$, i.e., $E(\\hat{\\boldsymbol{\\beta}}) = \\boldsymbol{\\beta}$\n\n. . .\n\n$Var(\\hat{\\boldsymbol{\\beta}})$, the matrix of variances and covariances between estimators, is found by taking the second partial derivatives of the log-likelihood function (Hessian matrix)\n\n$$\nVar(\\hat{\\boldsymbol{\\beta}}) = (\\mathbf{X}^T\\mathbf{V}\\mathbf{X})^{-1}\n$$\n\nwhere $\\mathbf{V}$ is a $n\\times n$ diagonal matrix such that $V_{ii}$ is the estimated variance for the $i^{th}$ observation\n\n## Test for a single coefficient\n\n**Hypotheses:** $H_0: \\beta_j = 0 \\hspace{2mm} \\text{ vs } \\hspace{2mm} H_a: \\beta_j \\neq 0$, given the other variables in the model\n\n. . .\n\n**(Wald) Test Statistic:** $$z = \\frac{\\hat{\\beta}_j - 0}{SE(\\hat{\\beta}_j)}$$\n\nwhere $SE(\\hat{\\beta}_j)$ is the square root of the $j^{th}$ diagonal element of $Var(\\hat{\\boldsymbol{\\beta}})$\n\n. . .\n\n**P-value:** $P(|Z| > |z|)$, where $Z \\sim N(0, 1)$, the Standard Normal distribution\n\n## Confidence interval for $\\beta_j$\n\nWe can calculate the **C% confidence interval** for $\\beta_j$ as the following:\n\n$$\n\\Large{\\hat{\\beta}_j \\pm z^* SE(\\hat{\\beta}_j)}\n$$\n\nwhere $z^*$ is calculated from the $N(0,1)$ distribution\n\n. . .\n\n::: callout-note\nThis is an interval for the change in the log-odds for every one unit increase in $x_j$\n:::\n\n## Interpretation in terms of the odds\n\nThe change in **odds** for every one unit increase in $x_j$.\n\n$$\n\\Large{\\exp\\{\\hat{\\beta}_j \\pm z^* SE(\\hat{\\beta}_j)\\}}\n$$\n\n. . .\n\n**Interpretation:** We are $C\\%$ confident that for every one unit increase in $x_j$, the odds multiply by a factor of $\\exp\\{\\hat{\\beta}_j - z^* SE(\\hat{\\beta}_j)\\}$ to $\\exp\\{\\hat{\\beta}_j + z^* SE(\\hat{\\beta}_j)\\}$, holding all else constant.\n\n## Coefficient for `age` {.midi}\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> term </th>\n   <th style=\"text-align:right;\"> estimate </th>\n   <th style=\"text-align:right;\"> std.error </th>\n   <th style=\"text-align:right;\"> statistic </th>\n   <th style=\"text-align:right;\"> p.value </th>\n   <th style=\"text-align:right;\"> conf.low </th>\n   <th style=\"text-align:right;\"> conf.high </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> (Intercept) </td>\n   <td style=\"text-align:right;\"> -6.673 </td>\n   <td style=\"text-align:right;\"> 0.378 </td>\n   <td style=\"text-align:right;\"> -17.647 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> -7.423 </td>\n   <td style=\"text-align:right;\"> -5.940 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;background-color: rgba(217, 227, 228, 255) !important;\"> age </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> 0.082 </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> 0.006 </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> 14.344 </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> 0.000 </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> 0.071 </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> 0.094 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> totChol </td>\n   <td style=\"text-align:right;\"> 0.002 </td>\n   <td style=\"text-align:right;\"> 0.001 </td>\n   <td style=\"text-align:right;\"> 1.940 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.004 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> currentSmoker1 </td>\n   <td style=\"text-align:right;\"> 0.443 </td>\n   <td style=\"text-align:right;\"> 0.094 </td>\n   <td style=\"text-align:right;\"> 4.733 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.260 </td>\n   <td style=\"text-align:right;\"> 0.627 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n. . .\n\n**Hypotheses:**\n\n$$\nH_0: \\beta_{age} = 0 \\hspace{2mm} \\text{ vs } \\hspace{2mm} H_a: \\beta_{age} \\neq 0\n$$, given total cholesterol and smoking status are in the model.\n\n## Coefficient for `age` {.midi}\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> term </th>\n   <th style=\"text-align:right;\"> estimate </th>\n   <th style=\"text-align:right;\"> std.error </th>\n   <th style=\"text-align:right;\"> statistic </th>\n   <th style=\"text-align:right;\"> p.value </th>\n   <th style=\"text-align:right;\"> conf.low </th>\n   <th style=\"text-align:right;\"> conf.high </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> (Intercept) </td>\n   <td style=\"text-align:right;\"> -6.673 </td>\n   <td style=\"text-align:right;\"> 0.378 </td>\n   <td style=\"text-align:right;\"> -17.647 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> -7.423 </td>\n   <td style=\"text-align:right;\"> -5.940 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;background-color: rgba(217, 227, 228, 255) !important;\"> age </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> 0.082 </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> 0.006 </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> 14.344 </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> 0.000 </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> 0.071 </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> 0.094 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> totChol </td>\n   <td style=\"text-align:right;\"> 0.002 </td>\n   <td style=\"text-align:right;\"> 0.001 </td>\n   <td style=\"text-align:right;\"> 1.940 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.004 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> currentSmoker1 </td>\n   <td style=\"text-align:right;\"> 0.443 </td>\n   <td style=\"text-align:right;\"> 0.094 </td>\n   <td style=\"text-align:right;\"> 4.733 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.260 </td>\n   <td style=\"text-align:right;\"> 0.627 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n**Test statistic:**\n\n$$z = \\frac{ 0.0825  - 0}{0.00575} = 14.34\n$$\n\n## Coefficient for `age` {.midi}\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> term </th>\n   <th style=\"text-align:right;\"> estimate </th>\n   <th style=\"text-align:right;\"> std.error </th>\n   <th style=\"text-align:right;\"> statistic </th>\n   <th style=\"text-align:right;\"> p.value </th>\n   <th style=\"text-align:right;\"> conf.low </th>\n   <th style=\"text-align:right;\"> conf.high </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> (Intercept) </td>\n   <td style=\"text-align:right;\"> -6.673 </td>\n   <td style=\"text-align:right;\"> 0.378 </td>\n   <td style=\"text-align:right;\"> -17.647 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> -7.423 </td>\n   <td style=\"text-align:right;\"> -5.940 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;background-color: rgba(217, 227, 228, 255) !important;\"> age </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> 0.082 </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> 0.006 </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> 14.344 </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> 0.000 </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> 0.071 </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> 0.094 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> totChol </td>\n   <td style=\"text-align:right;\"> 0.002 </td>\n   <td style=\"text-align:right;\"> 0.001 </td>\n   <td style=\"text-align:right;\"> 1.940 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.004 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> currentSmoker1 </td>\n   <td style=\"text-align:right;\"> 0.443 </td>\n   <td style=\"text-align:right;\"> 0.094 </td>\n   <td style=\"text-align:right;\"> 4.733 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.260 </td>\n   <td style=\"text-align:right;\"> 0.627 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n**P-value:**\n\n$$P(|Z| > |14.34|) \\approx 0\n$$\n\n. . .\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n2 * pnorm(14.34,lower.tail = FALSE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 1.230554e-46\n```\n\n\n:::\n:::\n\n\n\n## Coefficient for `age` {.midi}\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> term </th>\n   <th style=\"text-align:right;\"> estimate </th>\n   <th style=\"text-align:right;\"> std.error </th>\n   <th style=\"text-align:right;\"> statistic </th>\n   <th style=\"text-align:right;\"> p.value </th>\n   <th style=\"text-align:right;\"> conf.low </th>\n   <th style=\"text-align:right;\"> conf.high </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> (Intercept) </td>\n   <td style=\"text-align:right;\"> -6.673 </td>\n   <td style=\"text-align:right;\"> 0.378 </td>\n   <td style=\"text-align:right;\"> -17.647 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> -7.423 </td>\n   <td style=\"text-align:right;\"> -5.940 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;background-color: rgba(217, 227, 228, 255) !important;\"> age </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> 0.082 </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> 0.006 </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> 14.344 </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> 0.000 </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> 0.071 </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> 0.094 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> totChol </td>\n   <td style=\"text-align:right;\"> 0.002 </td>\n   <td style=\"text-align:right;\"> 0.001 </td>\n   <td style=\"text-align:right;\"> 1.940 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.004 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> currentSmoker1 </td>\n   <td style=\"text-align:right;\"> 0.443 </td>\n   <td style=\"text-align:right;\"> 0.094 </td>\n   <td style=\"text-align:right;\"> 4.733 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.260 </td>\n   <td style=\"text-align:right;\"> 0.627 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n**Conclusion:**\n\nThe p-value is very small, so we reject $H_0$. The data provide sufficient evidence that age is a statistically significant predictor of whether someone is high risk of having heart disease, after accounting for total cholesterol and smoking status.\n\n## CI for `age`\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> term </th>\n   <th style=\"text-align:right;\"> estimate </th>\n   <th style=\"text-align:right;\"> std.error </th>\n   <th style=\"text-align:right;\"> statistic </th>\n   <th style=\"text-align:right;\"> p.value </th>\n   <th style=\"text-align:right;\"> conf.low </th>\n   <th style=\"text-align:right;\"> conf.high </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> (Intercept) </td>\n   <td style=\"text-align:right;\"> -6.673 </td>\n   <td style=\"text-align:right;\"> 0.378 </td>\n   <td style=\"text-align:right;\"> -17.647 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> -7.423 </td>\n   <td style=\"text-align:right;\"> -5.940 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;background-color: rgba(217, 227, 228, 255) !important;\"> age </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> 0.082 </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> 0.006 </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> 14.344 </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> 0.000 </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> 0.071 </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> 0.094 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> totChol </td>\n   <td style=\"text-align:right;\"> 0.002 </td>\n   <td style=\"text-align:right;\"> 0.001 </td>\n   <td style=\"text-align:right;\"> 1.940 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.004 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> currentSmoker1 </td>\n   <td style=\"text-align:right;\"> 0.443 </td>\n   <td style=\"text-align:right;\"> 0.094 </td>\n   <td style=\"text-align:right;\"> 4.733 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.260 </td>\n   <td style=\"text-align:right;\"> 0.627 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n::: question\nInterpret the 95% confidence interval for `age` in terms of the **odds** of being high risk for heart disease.\n:::\n\n## Overview of testing coefficients\n\n**Test a single coefficient**\n\n-   Likelihood ratio test\n\n-   Drop-in-deviance test\n\n-   Wald hypothesis test and confidence interval\n\n. . .\n\n**Test a subset of coefficients**\n\n-   Likelihood ratio test\n\n-   Drop-in-deviance test\n\n. . .\n\nCan use AIC and BIC to compare models in both scenarios\n\n## References\n",
    "supporting": [
      "21-logistic-inference_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../site_libs/kePrint/kePrint.js\"></script>\n<link href=\"../site_libs/lightable/lightable.css\" rel=\"stylesheet\" />\n"
      ],
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}