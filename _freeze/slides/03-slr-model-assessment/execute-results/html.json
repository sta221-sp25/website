{
  "hash": "ea8a2723ecb1198bd17ce61a62c8d9b1",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"SLR: Model Assessment\"\nauthor: \"Prof. Maria Tackett\"\ndate: \"2024-09-03\"\ndate-format: \"MMM DD, YYYY\"\nfooter: \"[ðŸ”— STA 221 - Fall 2024](https://sta221-fa24.netlify.app)\"\nlogo: \"../images/logo.png\"\nformat: \n  revealjs:\n    theme: slides.scss\n    multiplex: false\n    transition: fade\n    slide-number: true\n    incremental: false \n    chalkboard: true\nhtml-math-method:\n  method: mathjax\n  url: \"https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js\"\nexecute:\n  freeze: auto\n  echo: true\nknitr:\n  opts_chunk: \n    R.options:      \n    width: 200\nbibliography: references.bib\n---\n\n\n\n\n\n## Announcements {.midi}\n\n-   Office hours start this week. See schedule on [Overview page](https://sta221-fa24.netlify.app/overview) of the course website or on [Canvas](https://canvas.duke.edu/courses/38867).\n\n# Questions from last class?\n\n## Topics\n\n-   Use R to conduct exploratory data analysis and fit a model\n-   Evaluate models using RMSE and $R^2$\n-   Use analysis of variance to partition variability in the response variable\n\n## Computing set up\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# load packages\nlibrary(tidyverse)   # for data wrangling and visualization\nlibrary(tidymodels)  # for modeling (includes broom, yardstick, and other packages)\nlibrary(openintro)   # for the duke_forest dataset\nlibrary(scales)      # for pretty axis labels\nlibrary(knitr)       # for pretty tables\nlibrary(patchwork)   # arrange plots\n\n# set default theme for ggplot2\nggplot2::theme_set(ggplot2::theme_bw())\n```\n:::\n\n\n\n## Data: Houses in Duke Forest\n\n::: columns\n::: {.column width=\"50%\"}\n-   Data on houses that were sold in the Duke Forest neighborhood of Durham, NC around November 2020\n-   Scraped from Zillow\n-   Source: [`openintro::duke_forest`](http://openintrostat.github.io/openintro/reference/duke_forest.html)\n:::\n\n::: {.column width=\"50%\"}\n![](images/03/duke_forest_home.jpg){fig-alt=\"Home in Duke Forest\"}\n:::\n:::\n\n**Goal**: Use the area (in square feet) to understand variability in the price of houses in Duke Forest.\n\n\n\n\n\n\n\n# Application exercise\n\n::: appex\nðŸ“‹ <https://sta221-fa24.netlify.app/ae/ae-01-slr.html>\n:::\n\n## Clone repo + Start new RStudio project {.midi}\n\n-   Go to the course organization. Click on the repo with the prefix `ae-01`. It contains the starter documents you need to complete the AE.\n\n-   Click on the green **CODE** button, select **Use SSH** (this might already be selected by default, and if it is, youâ€™ll see the text **Clone with SSH**). Click on the clipboard icon to copy the repo URL.\n\n-   In RStudio, go to *File* â†’ *New Project* â†’ *Version Control* â†’ *Git*.\n\n-   Copy and paste the URL of your assignment repo into the dialog box *Repository URL*.\n\n-   Click *Create Project*, and the files from your GitHub repo will be displayed in the *Files* pane in RStudio.\n\n-   Click `ae-01.qmd` to open the template Quarto file. This is where you will write up your code and narrative for the AE.\n\n# Model assessment\n\nWe fit a model but is it any good?\n\n## Two statistics\n\n-   **Root mean square error, RMSE**: A measure of the average error (average difference between observed and predicted values of the outcome)\n\n-   **R-squared**, $R^2$ : Percentage of variability in the outcome explained by the regression model (in the context of SLR, the predictor)\n\n. . .\n\n::: question\nWhat indicates a good model fit? Higher or lower RMSE? Higher or lower $R^2$?\n:::\n\n## RMSE\n\n$$\nRMSE = \\sqrt{\\frac{\\sum_{i=1}^n(y_i - \\hat{y}_i)^2}{n}} = \\sqrt{\\frac{\\sum_{i=1}^ne_i^2}{n}}\n$$\n\n. . .\n\n::: incremental\n-   Ranges between 0 (perfect predictor) and infinity (terrible predictor)\n\n-   Same units as the response variable\n\n-   The value of RMSE is more useful for comparing across models than evaluating a single model (more on this when we get to regression with multiple predictors)\n:::\n\n# ANOVA and $R^2$\n\n## ANOVA {#analysis-of-variance-anova}\n\n**Analysis of Variance (ANOVA)**: Technique to partition variability in $Y$ by the sources of variability\n\n<br>\n\n![](images/clipboard-3964457409.png)\n\n## Total variability (Response)\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](03-slr-model-assessment_files/figure-revealjs/unnamed-chunk-2-1.png){fig-align='center' width=80%}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n\n\n|   Min| Median|     Max|     Mean|  Std.Dev|\n|-----:|------:|-------:|--------:|--------:|\n| 95000| 540000| 1520000| 559898.7| 225448.1|\n\n\n:::\n:::\n\n\n\n## Partition sources of variability in `price`\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](03-slr-model-assessment_files/figure-revealjs/unnamed-chunk-4-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n\n## Total variability (Response)\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](03-slr-model-assessment_files/figure-revealjs/unnamed-chunk-5-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n\n$$\\text{Sum of Squares Total (SST)} = \\sum_{i=1}^n(y_i - \\bar{y})^2 = (n-1)s_y^2$$\n\n## Explained variability (Model)\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](03-slr-model-assessment_files/figure-revealjs/unnamed-chunk-6-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n\n$$\\text{Sum of Squares Model (SSM)} = \\sum_{i = 1}^{n}(\\hat{y}_i - \\bar{y})^2$$\n\n------------------------------------------------------------------------\n\n## Unexplained variability (Residuals)\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](03-slr-model-assessment_files/figure-revealjs/unnamed-chunk-7-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n\n$$\\text{Sum of Squares Residuals (SSR)} = \\sum_{i = 1}^{n}(y_i - \\hat{y}_i)^2$$\n\n## Sum of Squares\n\n<br>\n\n$$\n\\begin{aligned}\n\\color{#407E99}{SST} \\hspace{5mm}&= &\\color{#993399}{SSM} &\\hspace{5mm} +  &\\color{#8BB174}{SSR} \\\\[10pt]\n\\color{#407E99}{\\sum_{i=1}^n(y_i - \\bar{y})^2} \\hspace{5mm}&= &\\color{#993399}{\\sum_{i = 1}^{n}(\\hat{y}_i - \\bar{y})^2} &\\hspace{5mm}+ &\\color{#8BB174}{\\sum_{i = 1}^{n}(y_i - \\hat{y}_i)^2}\n\\end{aligned}\n$$\n\n## $R^2$\n\nThe **coefficient of determination** $R^2$ is the proportion of variation in the response, $Y$, that is explained by the regression model\n\n<br>\n\n$$\\large{R^2 = \\frac{SSM}{SST} = 1 - \\frac{SSR}{SST}}$$\n\n<br>\n\n::: question\nWhat is the range of $R^2$? Does $R^2$ have units?\n:::\n\n## Interpreting \\$R\\^2\\$ {.smaller}\n\n\n\n::: {.cell layout-align=\"center\"}\n\n:::\n\n\n\n::: panel-tabset\n## Question\n\n::: appex\nSubmit your response to the following question on Ed Discussion.\n\n::: midi\nThe $R^2$ of the model for price from area of houses in Duke Forest is 44.5%. Which of the following is the correct interpretation of this value?\n\n1.  Area correctly predicts 44.5% of price for houses in Duke Forest.\n2.  44.5% of the variability in price for houses in Duke Forest can be explained by area.\n3.  44.5% of the variability in area for houses in Duke Forest can be explained by price.\n4.  44.5% of the time price for houses in Duke Forest can be predicted by area.\n\nDo you think this model is useful for explaining variability in the price of Duke Forest houses?\n:::\n:::\n\n## Submit\n\n\n\n```{=html}\n<iframe allowfullscreen frameborder=\"0\" height=\"100%\" mozallowfullscreen style=\"min-width: 500px; min-height: 355px\" src=\"https://edstem.org/us/courses/62513/discussion/629888\" width=\"100%\"></iframe>\n```\n\n\n:::\n\nðŸ”— <https://edstem.org/us/courses/62513/discussion/629888>\n\n# Using R\n\n## Augmented data frame\n\nUse the `augment()` function from the **broom** package to add columns for predicted values, residuals, and other observation-level model statistics\n\n. . .\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nduke_forest_aug <- augment(duke_forest_fit)\nduke_forest_aug\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 98 Ã— 8\n     price  area  .fitted  .resid   .hat  .sigma   .cooksd .std.resid\n     <dbl> <dbl>    <dbl>   <dbl>  <dbl>   <dbl>     <dbl>      <dbl>\n 1 1520000  6040 1079931. 440069. 0.133  162605. 0.604         2.80  \n 2 1030000  4475  830340. 199660. 0.0435 168386. 0.0333        1.21  \n 3  420000  1745  394951.  25049. 0.0226 169664. 0.000260      0.150 \n 4  680000  2091  450132. 229868. 0.0157 168011. 0.0150        1.37  \n 5  428500  1772  399257.  29243. 0.0220 169657. 0.000345      0.175 \n 6  456000  1950  427645.  28355. 0.0182 169659. 0.000266      0.170 \n 7 1270000  3909  740072. 529928. 0.0250 160502. 0.130         3.18  \n 8  557450  2841  569744. -12294. 0.0102 169679. 0.0000277    -0.0732\n 9  697500  3924  742465. -44965. 0.0254 169620. 0.000948     -0.270 \n10  650000  2173  463209. 186791. 0.0145 168582. 0.00912       1.11  \n# â„¹ 88 more rows\n```\n\n\n:::\n:::\n\n\n\n## Finding RMSE in R\n\nUse the `rmse()` function from the **yardstick** package (part of **tidymodels**)\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nrmse(duke_forest_aug, truth = price, estimate = .fitted)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 Ã— 3\n  .metric .estimator .estimate\n  <chr>   <chr>          <dbl>\n1 rmse    standard     167067.\n```\n\n\n:::\n:::\n\n\n\n<br>\n\n::: question\nDo you think this model is useful for predicting the price of Duke Forest houses?\n:::\n\n## Finding $R^2$ in R\n\nUse the `rsq()` function from the **yardstick** package (part of **tidymodels**)\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nrsq(duke_forest_aug, truth = price, estimate = .fitted)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 Ã— 3\n  .metric .estimator .estimate\n  <chr>   <chr>          <dbl>\n1 rsq     standard       0.445\n```\n\n\n:::\n:::\n\n\n\n<br>\n\n. . .\n\nAlternatively, use `glance()` to construct a single row summary of the model fit, including $R^2$:\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nglance(duke_forest_fit)$r.squared\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.4451945\n```\n\n\n:::\n:::\n\n\n\n## Recap\n\n-   Used R to conduct exploratory data analysis and fit a model\n\n-   Evaluated models using RMSE and $R^2$\n\n-   Used analysis of variance to partition variability in the response variable\n\n## Next class\n\n-   Matrix representation of simple linear regression\n    -   See [Sep 5 prepare](../prepare/prepare-sep5.html)\n",
    "supporting": [
      "03-slr-model-assessment_files/figure-revealjs"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}