{
  "hash": "89b0a3709e0b3b5f1a64fbfbc4b01b4e",
  "result": {
    "markdown": "---\ntitle: ANOVA Output in R\nformat: html\n---\n\n\nWe will use the Tips data set for this example.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# load packages\nlibrary(tidyverse)\nlibrary(tidymodels)\nlibrary(knitr)\n```\n:::\n\n::: {.cell}\n\n:::\n\n\nThe variables of interest in this analysis are\n\n-   `Party`: Number of people in the party\n-   `Meal`: Time of day (Lunch, Dinner, Late Night)\n-   `Age`: Age category of person paying the bill (Yadult, Middle, SenCit)\n\n## Model fit\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntip_fit <- linear_reg() |>\n  set_engine(\"lm\") |>\n  fit(Tip ~ Party + Age, data = tips)\n\ntidy(tip_fit) |>\n  kable(digits = 2)\n```\n\n::: {.cell-output-display}\n|term        | estimate| std.error| statistic| p.value|\n|:-----------|--------:|---------:|---------:|-------:|\n|(Intercept) |    -0.17|      0.37|     -0.46|    0.64|\n|Party       |     1.84|      0.12|     14.76|    0.00|\n|AgeMiddle   |     1.01|      0.41|      2.47|    0.01|\n|AgeSenCit   |     1.39|      0.48|      2.86|    0.00|\n:::\n:::\n\n\n## ANOVA\n\nBelow is the ANOVA output for the model fit above.\n\n\n::: {.cell tbl-colwidths='[60,40]'}\n\n```{.r .cell-code}\nanova(tip_fit$fit) |>\n  tidy() |>\n  kable(digits = 2)\n```\n\n::: {.cell-output-display}\n|term      |  df|   sumsq|  meansq| statistic| p.value|\n|:---------|---:|-------:|-------:|---------:|-------:|\n|Party     |   1| 1188.64| 1188.64|    285.71|    0.00|\n|Age       |   2|   38.03|   19.01|      4.57|    0.01|\n|Residuals | 165|  686.44|    4.16|        NA|      NA|\n:::\n:::\n\n\nWe will focus on the sum of squares in this document. The sum of squares are as follows:\n\n\\$\\$\n\n\n```{=tex}\n\\begin{aligned}\n&SS_{Party} = 1188.64 \\\\\n&SS_{Age|Party} = 38.03 \\\\\n&SS_{Error} = SS_{Residuals} = 686.44 \\\\\n&SS_{Total} = 1913.11\n\\end{aligned}\n```\n\n\\$\\$\n\n## Sum of squares in ANOVA table\n\nR uses a sequential method to calculate sum of squares for the variables in the model. This means that the sum of squares attributed to each variable is the variation in the response explained by that variable after accounting for the total variation explained by the other variables already in the model.\n\nThe order of the sequence is determined by the order of the variables in the model fit code. This order is reflected in the order the variables appear in the ANOVA output. The sequential sum of squares attributed to each variable will change if the order of the variables in the model changes; however, the sum of squares attributed to the model overall will **not** change, regardless of the order of the variables.\n\nLet's take a look at the sum of squares for `Party`, the first variable in the model. This value is calculated as the total variation in `Tips` explained by `Party` only. We can calculate this value by looking at the ANOVA table for simple linear regression model where `Party` is the only predictor.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nparty_fit <- linear_reg() |>\n  set_engine(\"lm\") |>\n  fit(Tip ~ Party, data = tips)\n\nanova(party_fit$fit) |>\n  tidy() |>\n  kable(digits = 2)\n```\n\n::: {.cell-output-display}\n|term      |  df|   sumsq|  meansq| statistic| p.value|\n|:---------|---:|-------:|-------:|---------:|-------:|\n|Party     |   1| 1188.64| 1188.64|       274|       0|\n|Residuals | 167|  724.47|    4.34|        NA|      NA|\n:::\n:::\n\n\nNotice that the sum of squares in this table is the value of $SS_{Party}$ above.\n\nNext, let's add `Age` to the model. The sum of squares associated with `Age` is the additional variation in `Tips` explained by `Age` <u>after</u> accounting for variation explained by `Party`. This can be understood as the additional model variation in the model with `Party` and `Age` compared to a model that only includes `Party`. We can calculate this additional variation as follows:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nanova(party_fit$fit, tip_fit$fit) |>\n  tidy() |>\n  kable(digits = 2)\n```\n\n::: {.cell-output-display}\n|term              | df.residual|    rss| df| sumsq| statistic| p.value|\n|:-----------------|-----------:|------:|--:|-----:|---------:|-------:|\n|Tip ~ Party       |         167| 724.47| NA|    NA|        NA|      NA|\n|Tip ~ Party + Age |         165| 686.44|  2| 38.03|      4.57|    0.01|\n:::\n:::\n\n\nNotice that the sum of squares in this table is the value of $SS_{Age|Party}$ above.\n\n::: callout-note\nWhen we input two model is the `anova()` function, e.g., `anova(Model 1, Model 2)`, the output produced is the additional sum of squares accounted for by the new variable(s) in `Model 2` after accounting for the variables in `Model 1`. In this case, it is the additional sum of squares accounted for by `Age` after accounting for `Party`.\n:::\n\nWhen we use the ANOVA table, we are most interested in the variation in the response explained by the entire model, not the contribution from each variable. Therefore, we will primarily consider the $SS_{Model}$, Sum of Squares Model. Because sum of squares are additive, it can be calculated as\n\n\n$$\n\\begin{aligned}\nSS_{Model} &= SS_{Total} - SS_{Error} \\\\\n&= 1913.11 - 686.44 \\\\ \n& = 1226.67 \n\\end{aligned}\n$$It can also be calculated as\n\n$$\n\\begin{aligned}\nSS_{Model} &= SS_{Party} + SS_{Age | Party} \\\\\n& = 1188.64 + 38.03 \\\\\n& = 1226.67\n\\end{aligned}\n$$\n",
    "supporting": [
      "ANOVA-Table_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}