{
  "hash": "a5551e9ef12131e4104222ce291f9a35",
  "result": {
    "markdown": "---\ntitle: \"AE 16: Exam 02 Review\"\ndate: \"Dec 05, 2022\"\neditor: visual\nexecute: \n  warning: false\n  message: false\neditor_options: \n  chunk_output_type: console\n---\n\n\n::: callout-important\nThe AE is due on GitHub by Thursday, December 08, 11:59pm.\\\n\\\nNote: This in-class review is <u>not</u> exhaustive. Use lecture notes notes, application exercises, labs, homework, and readings for a comprehensive exam review.\n:::\n\n## Packages\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(tidymodels)\nlibrary(knitr)\n```\n:::\n\n\n# Part 1: Multiple linear regression\n\n**The goal of this analysis is to use characteristics of loan applications to predict the interest rate on the loan.** We will use a random sample of loans given by Lending Club, a peer-to-peer lending service. The random sample was drawn from `loans_full_schema` in the **openintro** R package. [Click here](https://www.openintro.org/data/index.php?data=loans_full_schema) for the codebook.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nloans <- read_csv(\"data/loans-sample.csv\")\n```\n:::\n\n\n## Exercise 1\n\nSplit the data into training (75%) and testing (25%) sets. Use seed `1205`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# add code here\n```\n:::\n\n\n## Exercise 2\n\nWrite the equation of the statistical model for predicting interest rate (`interest_rate`) from debt to income ratio (`debt_to_income`), the term of loan (`term`), the number of inquiries (credit checks) into the applicant's credit during the last 12 months (`inquiries_last_12m`), whether there are any bankruptcies listed in the public record for this applicant (`bankrupt`), and the type of application (`application_type`). The model should allow for the effect of debt to income ratio on interest rate to vary by application type.\n\n*\\[Add model here\\]*\n\n## Exercise 3\n\nSpecify a linear regression model. Call it `loans_spec`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# add code here\n```\n:::\n\n\n## Exercise 4\n\nUse the training data to build the following recipe:\n\n-   Predict `interest_rate` from `debt_to_income`, `term`, `inquiries_last_12m`, `public_record_bankrupt`, and `application_type`.\n-   Mean center `debt_to_income`.\n-   Make `term` a factor.\n-   Create a new variable: `bankrupt` that takes on the value \"no\" if `public_record_bankrupt` is 0 and the value \"yes\" if `public_record_bankrupt` is 1 or higher. Then, remove `public_record_bankrupt`.\n-   Interact `application_type` with `debt_to_income`.\n-   Create dummy variables where needed and drop any zero variance variables.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# add code here\n```\n:::\n\n\n## Exercise 5\n\nCreate the workflow that brings together the model specification and recipe.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# add code here\n```\n:::\n\n\n## Exercise 6\n\nConduct 10-fold cross validation. Use the seed `1205`. You will only collect the default metrics, $R^2$ and RMSE. You do <u>not</u> need to collect AIC, BIC or Adj. $R^2$.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# add code here\n```\n:::\n\n\n## Exercise 7\n\nCollect and summarize $R^2$ and RMSE metrics from your CV resamples.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# add code here\n```\n:::\n\n\nWhy are we focusing on $R^2$ and RMSE instead of adjusted $R^2$, AIC, BIC?\n\n*\\[Add response here\\]*\n\n## Exercise 8\n\nRefit the model on the entire training data.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# add code here\n```\n:::\n\n\nThen, interpret the following in the context of the data:\n\n-   Intercept\n\n-   `debt_to_income` for joint applications\n\n-   `term`\n\n# Part 2: Logistic regression\n\n## Data\n\nAs part of a study of the effects of predatory invasive crab species on snail populations, researchers measured the mean closing forces and the propodus heights of the claws on several crabs of three species.\n\n![](images/claw.png){fig-align=\"center\"}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nclaws <- read_csv(\"data/claws.csv\") |>\n  mutate(lb = as_factor(lb))\n```\n:::\n\n\nThe data set contains following variables:\n\n-   `force`: Closing force of claw (newtons)\n-   `height`: Propodus height (mm)\n-   `species`: Crab species - Cp(Cancer productus), Hn (Hemigrapsus nudus), Lb(Lophopanopeus bellus)\n-   `lb`: 1 if Lophopanopeus bellus species, 0 otherwise\n-   `hn`: 1 if Hemigrapsus nudus species, 0 otherwise\n-   `cp`: 1 if Cancer productus species, 0 otherwise\n-   `force_cent`: mean centered force\n-   `height_cent`: mean centered height\n\n## Getting started\n\n-   Why do we use the log-odds as the response variable?\n\n*\\[Add response here\\]*\n\n-   Fill in the blanks:\n\n    -   Use log-odds to ...\n\n    -   Use odds to ...\n\n    -   Use probabilities to ...\n\n-   Suppose we want to use force to determine whether or not a crab is from the Lophopanopeus bellus (Lb) species. Why should we use a logistic regression model for this analysis?\n\n## Exercise 9\n\nWe will use `force_cent`, the mean-centered variable for force in the model. The model output is below. Write the equation of the model produced by R. Don't forget to fill in the blanks for `â€¦`.\n\n\n::: {.cell}\n::: {.cell-output-display}\n|term        | estimate| std.error| statistic| p.value| conf.low| conf.high|\n|:-----------|--------:|---------:|---------:|-------:|--------:|---------:|\n|(Intercept) |   -0.798|     0.358|    -2.233|   0.026|   -1.542|    -0.123|\n|force_cent  |    0.043|     0.039|     1.090|   0.276|   -0.034|     0.123|\n:::\n:::\n\n\nLet $\\pi$ be...\n\n\n$$\\log\\Big(\\frac{\\hat{\\pi}}{1 - \\hat{\\pi}}\\Big) = $$\n\n\n## Exercise 10\n\nInterpret the intercept in the context of the data.\n\n## Exercise 11\n\nInterpret the effect of force in the context of the data.\n\n## Exercise 12\n\nNow let's consider adding height to the model. Fit the model that includes `height_cent`. Then use AIC to choose the model that best fits the data.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlb_fit_2 <- logistic_reg() |>\n  set_engine(\"glm\") |>\n  fit(lb ~ force_cent + height_cent, data = claws)\n\ntidy(lb_fit_2, conf.int = TRUE) |>\n  kable(digits = 3)\n```\n\n::: {.cell-output-display}\n|term        | estimate| std.error| statistic| p.value| conf.low| conf.high|\n|:-----------|--------:|---------:|---------:|-------:|--------:|---------:|\n|(Intercept) |   -1.130|     0.463|    -2.443|   0.015|   -2.167|    -0.306|\n|force_cent  |    0.211|     0.092|     2.279|   0.023|    0.056|     0.424|\n|height_cent |   -0.895|     0.398|    -2.249|   0.025|   -1.815|    -0.234|\n:::\n:::\n\n\n## Exercise 13\n\nWhat do the following mean in the context of this data. Explain and calculate them.\n\n-   Sensitivity: ...\n\n-   Specificity: ...\n\n-   Negative predictive power: ...\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}