{
  "hash": "b292f4fec48c4cfb74839512f93dcdd6",
  "result": {
    "markdown": "---\ntitle: \"AE 13: Logistic regression introduction\"\ndate: \"Nov 02, 2022\"\neditor: visual\nexecute: \n  warning: false\n  message: false\n---\n\n\n::: callout-important\nGo to the [course GitHub organization](https://github.com/sta210-fa22) and locate your `ae-13`- to get started.\n\nThe AE is due on GitHub by Saturday, November 05 , 11:59pm.\n:::\n\n## Packages\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(tidymodels)\nlibrary(knitr)\n\nheart_disease <- read_csv(\"data/framingham.csv\") |>\n  select(totChol, TenYearCHD) |>\n  drop_na() |>\n  mutate(high_risk = as.factor(TenYearCHD)) |>\n  select(totChol, high_risk)\n```\n:::\n\n\n## Linear regression vs. logistic regression\n\nState whether a linear regression model or logistic regression model is more appropriate for each scenario:\n\n1.  Use age and education to predict if a randomly selected person will vote in the next election.\n\n2.  Use budget and run time (in minutes) to predict a movie's total revenue.\n\n3.  Use age and sex to calculate the probability a randomly selected adult will visit Duke Health in the next year.\n\n## Heart disease\n\n### Data: Framingham study\n\nThis data set is from an ongoing cardiovascular study on residents of the town of Framingham, Massachusetts. We want to use the total cholesterol to predict if a randomly selected adult is high risk for heart disease in the next 10 years.\n\n-   `high_risk`:\n    -   1: High risk of having heart disease in next 10 years\n    -   0: Not high risk of having heart disease in next 10 years\n-   `totChol`: total cholesterol (mg/dL)\n\n### Outcome: `high_risk`\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = heart_disease, aes(x = high_risk)) + \n  geom_bar() + \n  scale_x_discrete(labels = c(\"1\" = \"High risk\", \"0\" = \"Low risk\")) +\n  labs(\n    title = \"Distribution of 10-year risk of heart disease\", \n    x = NULL)\n```\n\n::: {.cell-output-display}\n![](ae-13-logistic-intro_files/figure-html/unnamed-chunk-2-1.png){width=70%}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nheart_disease |>\n  count(high_risk)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 2 Ã— 2\n  high_risk     n\n  <fct>     <int>\n1 0          3555\n2 1           635\n```\n:::\n:::\n\n\n### Calculating probability and odds\n\n1.  What is the probability a randomly selected person in the study is **not** high risk for heart disease?\n\n2.  What are the **odds** a randomly selected person in the study is **not** high risk for heart disease?\n\n### Logistic regression model\n\nFit a logistic regression model to understand the relationship between total cholesterol and risk for heart disease.\n\nLet $\\pi$ be the probability an adult is high risk of heart disease. The statistical model is\n\n\n$$\\log\\Big(\\frac{\\pi_i}{1-\\pi_i}\\Big) = \\beta_0 + \\beta_1 TotChol_i$$\n\n::: {.cell}\n\n```{.r .cell-code}\nheart_disease_fit <- logistic_reg() |>\n  set_engine(\"glm\") |>\n  fit(high_risk ~ totChol, data = heart_disease, family = \"binomial\")\n\ntidy(heart_disease_fit) |> kable(digits = 3)\n```\n\n::: {.cell-output-display}\n|term        | estimate| std.error| statistic| p.value|\n|:-----------|--------:|---------:|---------:|-------:|\n|(Intercept) |   -2.894|     0.230|   -12.607|       0|\n|totChol     |    0.005|     0.001|     5.268|       0|\n:::\n:::\n\n\n3.  Write the regression equation. Round to 3 digits.\n\n### Calculating log-odds, odds and probabilities\n\nBased on the model, if a randomly selected person has a total cholesterol of 250 mg/dL,\n\n4.  What are the log-odds they are high risk for heart disease?\n\n5.  What are the odds they are high risk for heart disease?\n\n6.  What is the probability they are high risk for heart disease? *Use the odds to calculate your answer.*\n\n### Comparing observations\n\nSuppose a person's cholesterol changes from 250 mg/dL to 200 mg/dL.\n\n7.  How do you expect the log-odds that this person is high risk for heart disease to change?\n\n8.  How do you expect the odds that this person is high risk for heart disease to change?\n",
    "supporting": [
      "ae-13-logistic-intro_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}